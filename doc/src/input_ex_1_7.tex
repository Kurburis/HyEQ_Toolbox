
\begin{example}{biological example: synchronization of two fireflies}
\label{ex:fireflies}
Consider a biological example of the synchronization of two fireflies flashing. The fireflies can be modeled mathematically as periodic oscillators which tend to synchronize their flashing until they are flashing in phase with each other. A state value of $\tau_i=1$ corresponds to a flash, and after each flash, the firefly automatically resets its internal timer (periodic cycle) to $\tau_i=0$.  The synchronization of the fireflies can be modeled as an interconnection of two hybrid systems because every time one firefly flashes, the other firefly notices and jumps ahead in its internal timer $\tau$ by $(1+\varepsilon)\tau$, where $\varepsilon$ is a biologically determined coefficient. This happens until eventually both fireflies synchronize their internal timers and are flashing simultaneously.  
\begin{figure}[ht!]
  \begin{center}
    {\includegraphics[width=.45\textwidth]{figures/Simulink/fireflies.eps}}
   \caption{Interconnection Diagram for Example~\ref{ex:fireflies}}
\label{fig:fireflies}
  \end{center}
\end{figure}
Each firefly can be modeled as a hybrid system given by
\begin{eqnarray}
f_i(\tau_i,u_i) & := & 1, \\
C_i &: =& \defset{(\tau_i,u_i)\in \Re^{2}}{0 \leq \tau_i \leq 1}\cap
\defset{(\tau_i,u_i)\in \Re^{2}}{0 \leq u_i \leq 1} \\
%\defset{(\tau_i,u_i)\in \Re^{2}}{(0 < \tau_i < 1), \cup (0 < u_i \leq 1)} \\
g_i(\tau_i,u_i) &:=&
\left\{
\begin{array}{ll}
(1+ \varepsilon)\tau_i
& (1+\varepsilon)\tau_i<1\\
0
& (1+\varepsilon)\tau_i\geq 1
\end{array}
\right. \\
    D_i &: =& \defset{(\tau_i,u_i)\in \Re^{2}}{\tau_i = 1} \cup \defset{(\tau_i,u_i)\in \Re^{2}}{u_i = 1}.
\end{eqnarray}
The interconnection diagram for this example is simpler than in the previous example because now no external inputs are being considered. The only event that affects the flashing of a firefly is the flashing of the other firefly. The interconnection diagram can be seen in Figure~\ref{fig:fireflies}.
%\ricardo{I removed the space between ``Figure'' and tilde you were putting
%as the reason of using a tilde is for "Figure" to stay together with the number (i.e., prevent hyphens due to spilling out a line.}

%\ricardo{Perhaps we should combine the figures below into subfigures so that they don't take
%so much space.  Perhaps two 1x2 grid of figures?}

\begin{figure}[ht]
  \psfrag{flows [t]}[c]{flows [$t$]}
  \psfrag{jumps [j]}[c]{jumps [$j$]}
  \psfrag{tau1}[c]{$\tau_1$}
  \psfrag{tau2}[c]{$\tau_2$}
  \centering
\subfigure[Solution for system $\HS_1$]{
    \includegraphics[width=0.45\textwidth]{figures/Examples/fireflyH1.eps}
\label{fig:fireflyH1}}
\qquad
\subfigure[Solution for system $\HS_2$]{
    \includegraphics[width=0.45\textwidth]{figures/Examples/fireflyH2.eps}
\label{fig:fireflyH2}}
  \caption{Solution of Example \ref{ex:fireflies}}
\end{figure}

\begin{figure}[ht]
  \begin{center}
  \psfrag{flows [t]}[c]{flows [$t$]}
  \psfrag{jumps [j]}[c]{jumps [$j$]}
  \psfrag{tau1, tau2}[c]{$\tau_1, \tau_2$}
    {\includegraphics[width=.8\textwidth]{figures/Examples/fireflyH1H2.eps}}
   \caption{Solution of Example~\ref{ex:fireflies} for interconnection of $\HS_1$ and $\HS_2$}
\label{fig:fireflyH1H2}
  \end{center}
\end{figure}


% Set the location for MATLAB files included via the "\code" command.
\codeLocation{Matlab2tex_1_7}

For hybrid system $\HS_i$, $i = 1,2$:
\code{f.m}
\code{C.m}
\code{g.m}
\code{D.m}

% Flow map
% %\scriptsize
% \input{Matlab2tex_1_7/f.tex}\label{scr:f}
% %\normalsize

% Flow set
% %\scriptsize
% \input{Matlab2tex_1_7/C.tex}\label{scr:C}
% %\normalsize

% Jump map
% %\scriptsize
% \input{Matlab2tex_1_7/g.tex}\label{scr:g}
% %\normalsize

% Jump set
% %\scriptsize
% \input{Matlab2tex_1_7/D.tex}\label{scr:D}
% %\normalsize

A solution to the interconnection of hybrid systems $\HS_1$ and
$\HS_2$ with $T=15, J=15$, $rule =1$, $\varepsilon=0.3$ is depicted in Figure~\ref{fig:fireflyH1H2}. Both the projection onto $t$ and $j$ are shown. A solution to the hybrid system $\HS_1$ is depicted in Figure~\ref{fig:fireflyH1}. A solution to the hybrid system $\HS_2$ is depicted in Figure~\ref{fig:fireflyH2}.

These simulations reflect the expected behavior of the interconnected hybrid systems. The fireflies initially flash out of phase with one another and then synchronize to flash in the same phase.

For MATLAB/Simulink files of this example, see \IfSAE{Examples/Example\_\ref{ex:fireflies}}{Examples/Example\_1.7}.

\end{example}



