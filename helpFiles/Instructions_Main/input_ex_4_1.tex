\begin{example}{Implementation of a FSM}\label{ex:FSM}

\begin{figure}
  \begin{center}
    {\includegraphics[width=0.6\textwidth]{figures/Simulink/FSM_example.eps}}
   \caption{Simulation of a Finite State Machine (FSM) in Example~\ref{ex:FSM}.}
\label{fig:FSM_example}
  \end{center}
\end{figure}

Transitions of the state of a FSM are triggered by changes of its input $\uc$.
The system can be modeled as a cascade of two systems,
in which an external signal drives the FSM. 
\IfSAE
{
A finite state machine (FSM) or deterministic finite automaton (DFA) is a system with
inputs, states, and outputs taking values from discrete sets that are updated at discrete transitions (or jumps)
triggered by its inputs. 
Then, given a FSM and an initial state $\xlogic_0 \in \xlogicSpace$,  
a transition to a state $\xlogic_1 = \delta(\xlogic_0,\uc)$ is performed
when an input $\uc \in \Sigma$ is applied to it.
After the transition, the output of the FSM is updated to $\hc(\xlogic_1)$.
This mechanism can be captured by the difference equation
\begin{eqnarray}\label{eqn:FSMmodel}
\xlogic^+ & = & \delta(\xlogic,\uc)  \qquad \yc \ = \ \hc(\xlogic) \qquad (\xlogic,\uc)  \in \xlogicSpace \times \Sigma
\end{eqnarray}
This model captures the dynamics
the model of the cyber components 
in the instructions document
with
$$
\xc = \xlogic, \qquad \xcSpace = \xlogicSpace, \qquad \ucSpace = \Sigma, \qquad \gc = \delta, \qquad \Dc = \xcSpace\times\ucSpace
$$
Note that there is no notion of time associated with the FSM model above. An example of this model is presented in Example~\ref{ex:FSM}. 
}
{The FSM is modeled as the difference equation in \eqref{eqn:FSMmodel}.}
Assuming that the input feeds the input $u$ of the FSM, 
the state of the FSM is updated according to the transition function evaluated at the current input, that is,
$\xlogic$ is updated according to
 $$
\xlogic^+  =  \delta(\xlogic,u)
$$

The above model can be summarized as follows:

\begin{align}\label{eqn:CTdynamicsHcFSM}
f(\xlogic, u)&:= \begin{bmatrix}0\\0\end{bmatrix},\\ 
   C :=& \defset{(\xlogic,u)\in\{1,2\}\times\{1,2\}\times\{1,2\}\times\{1,2\}}{ \delta(\xlogic,u) =  \xlogic},\\
g(\xlogic, u)&:= \delta(\xlogic, u) = \begin{bmatrix}3-u_1\\3-u_2\end{bmatrix}, \\
    D :=& \defset{(\xlogic,u)\in\{1,2\}\times\{1,2\}\times\{1,2\}\times\{1,2\}}{ \delta(\xlogic,u) \in\{1,2\}\times\{1,2\}\setminus \xlogic},\\ 
y &:= h(\xlogic) =\xlogic
\end{align}
where the input and the state are given by $u = (u_1,u_2) \in\{1,2\}\times\{1,2\}$, and $\xlogic=(\xlogic_1,\xlogic_2)\in\{1,2\}\times\{1,2\}$, respectively.

For the hybrid system FSM in Figure~\ref{fig:FSM_example} we have the following Matlab embedded functions that describe the sets $C$ and $D$ and functions $f$ and $g$.
Figure~\ref{fig:FSMresults} depicts the corresponding inputs and state of the FSM.

\begin{figure}[ht]
  \begin{center}
    \includegraphics[width=0.8\textwidth]{figures/Simulink/FSMresults.eps}
   \caption{Finite state machine states and inputs.}
\label{fig:FSMresults}
  \end{center}
\end{figure}



Flow map
%\scriptsize
\input{Matlab2tex_FSM/f.tex}\label{scr:f}
%\normalsize

Flow set
%\scriptsize
\input{Matlab2tex_FSM/C.tex}\label{scr:C}
%\normalsize

Jump map
%\scriptsize
\input{Matlab2tex_FSM/g.tex}\label{scr:g}
%\normalsize

Jump set
%\scriptsize
\input{Matlab2tex_FSM/D.tex}\label{scr:D}
%\normalsize


\end{example}
