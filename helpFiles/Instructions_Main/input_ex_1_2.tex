The example below shows how to use the HyEQ solver to simulate a bouncing ball.

\begin{example}{bouncing ball with Lite HyEQ Solver}
\label{ex:bblite} Consider the hybrid system model for the bouncing ball with data given in Example~1.1.

For this example, we consider the ball to be bouncing on a floor at zero height. The constants for the bouncing ball system are $\gamma = 9.81$ and $\lambda=0.8$.
The following procedure is used to simulate this example in the Lite HyEQ Solver:
\begin{itemize}
\item Inside the MATLAB script {\tt run.m}, initial conditions, simulation horizons, a rule for jumps, ode solver options, and a step size coefficient are defined. The function {\tt HyEQsolver.m} is called in order to run the simulation, and a script for plotting solutions is included.
\item Then the MATLAB functions {\tt f.m, C.m, g.m, D.m} are edited according to the data given above.
\item Finally, the simulation is run by clicking the run button in {\tt run.m} or by calling {\tt run.m} in the MATLAB command window.
\end{itemize}

Example code for each of the MATLAB files {\tt run.m, f.m, C.m, g.m,} and {\tt D.m} is given below.\\

%\scriptsize
\input{Matlab2tex_1_2/run.tex}\label{scr:run}
%\normalsize

%\scriptsize
\input{Matlab2tex_1_2/f.tex}\label{scr:f}
%\normalsize

%\scriptsize
\input{Matlab2tex_1_2/C.tex}\label{scr:C}
%\normalsize

%\scriptsize
\input{Matlab2tex_1_2/g.tex}\label{scr:g}
%\normalsize

%\scriptsize
\input{Matlab2tex_1_2/D.tex}\label{scr:D}
%\normalsize

\begin{figure}[ht]
  \centering
  \psfrag{flows [t]}[c]{flows [$t$]}
  \psfrag{jumps [j]}[c]{jumps [$j$]}
  \psfrag{x1}[c]{$x_1$}
  \psfrag{x2}[c]{$x_2$}
\subfigure[Height]{
    \includegraphics[width=.45\textwidth]{figures/Examples/FlowsAndJumps1lite.eps}
\label{fig:lite-1}}
\qquad
\subfigure[Velocity]{
    \includegraphics[width=.45\textwidth]{figures/Examples/FlowsAndJumps2lite.eps}
\label{fig:lite-2}}
\caption{Solution of Example \ref{ex:bblite}}
\end{figure}

\begin{figure}[ht]
  \begin{center}
  \psfrag{t}[c]{$t$}
  \psfrag{j}[c]{$j$}
  \psfrag{x1}[c]{$x_1$}
    \includegraphics[width=.8\textwidth]{figures/Examples/HybridArclite.eps}
   \caption{Hybrid arc corresponding to a solution of Example~\ref{ex:bblite}: height}
\label{fig:lite-3}
  \end{center}
\end{figure}

A solution to the bouncing ball system from $x(0,0)=[1,0]^\top$ and with $TSPAN = [0 \hspace{2mm} 10], JSPAN = [0 \hspace{2mm} 20]$, $rule =1$, is depicted in Figure~\ref{fig:lite-1} (height) and Figure~\ref{fig:lite-2} (velocity).  Both the projection onto $t$ and $j$ are shown. Figure~\ref{fig:lite-3} depicts the corresponding hybrid arc for the position state.

For MATLAB files of this example, see Examples/Example\_\ref{ex:bblite}.

\end{example}
