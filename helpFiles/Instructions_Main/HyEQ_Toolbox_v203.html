<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,html --> 
<meta name="src" content="HyEQ_Toolbox_v203.tex" /> 
<meta name="date" content="2016-04-10 13:16:00" /> 
<link rel="stylesheet" type="text/css" href="HyEQ_Toolbox_v203.css" /> 
</head><body 
>
<!--l. 54--><p class="noindent" ><span 
class="cmbx-12x-x-144">Hybrid Equations (HyEQ) Toolbox</span> <span 
class="cmbx-12x-x-144">v2.03</span><br />
<span 
class="cmti-12x-x-144">A Toolbox for Simulating Hybrid Systems in</span>
<span 
class="cmti-12x-x-144">MATLAB/Simulink</span><sup><span 
class="cmmi-12">®</span><span 
class="cmr-12">;</span></sup>  <br />
<a 
 id="x1-1doc"></a></p>
   <div class="minipage"><div class="minipage"><div class="center" 
>
<!--l. 61--><p class="noindent" >
</p><!--l. 62--><p class="noindent" >Ricardo G. Sanfelice<br />
<span 
class="cmti-10">University of California</span><br />
<span 
class="cmti-10">Santa Cruz, CA 95064</span><br />
<span 
class="cmti-10">USA</span></p></div></div> <div class="minipage"><div class="center" 
>
<!--l. 68--><p class="noindent" >
</p><!--l. 69--><p class="noindent" >David A. Copp<br />
<span 
class="cmti-10">University of California</span><br />
<span 
class="cmti-10">Santa Barbara, CA 93109</span><br />
<span 
class="cmti-10">USA</span></p></div></div> <div class="minipage"><div class="center" 
>
<!--l. 75--><p class="noindent" >
</p><!--l. 76--><p class="noindent" >Pablo Nanez<br />
<span 
class="cmti-10">Universidad de Los Andes</span><br />
<span 
class="cmti-10">Colombia</span></p></div></div></div>
<div class="center" 
>
<!--l. 83--><p class="noindent" >
</p><!--l. 84--><p class="noindent" >April 10, 2016</p></div>
   <div 
class="abstract" 
>
<div class="center" 
>
<!--l. 90--><p class="noindent" >
</p><!--l. 90--><p class="noindent" ><span 
class="cmbx-9">Abstract</span></p></div>
     <!--l. 91--><p class="indent" >    <span 
class="cmr-9">This  note  describes  the  Hybrid  Equations  (HyEQ)  Toolbox  implemented  in  MATLAB/Simulink</span>
     <span 
class="cmr-9">for the simulation of hybrid dynamical systems. This toolbox is capable of simulating individual and</span>
     <span 
class="cmr-9">interconnected hybrid systems where multiple hybrid systems are connected and interact such as a</span>
     <span 
class="cmr-9">bouncing  ball  on  a  moving  platform,  fireflies  synchronizing  their  flashing,  and  more.  The  Simulink</span>
     <span 
class="cmr-9">implementation includes four basic blocks that define the dynamics of a hybrid system. These include</span>
     <span 
class="cmr-9">a flow map, flow set, jump map, and jump set. The flows and jumps of the system are computed by</span>
     <span 
class="cmr-9">the integrator system which is comprised of blocks that compute the continuous dynamics of the hybrid</span>
     <span 
class="cmr-9">system, trigger jumps, update the state of the system and simulation time at jumps, and stop the</span>
     <span 
class="cmr-9">simulation. We also describe a &#8220;lite simulator&#8221; which allows for faster simulation.</span>
</p>
</div>
                                                                                         
                                                                                         
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Introduction</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Installation</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-40003" id="QQ2-1-4"> Lite HyEQ Simulator: A stand-alone MATLAB code for simulation of
hybrid systems without inputs</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-50003.1" id="QQ2-1-7">Solver Function</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.1 <a 
href="#x1-60003.1.1" id="QQ2-1-8">Events Detection</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >3.1.2 <a 
href="#x1-70003.1.2" id="QQ2-1-9">Jump Map</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-80003.2" id="QQ2-1-10">Software Requirements</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.3 <a 
href="#x1-90003.3" id="QQ2-1-11">Configuration of Solver</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.4 <a 
href="#x1-100003.4" id="QQ2-1-12">Initialization</a></span>
<br />   &#x00A0;<span class="subsectionToc" >3.5 <a 
href="#x1-110003.5" id="QQ2-1-13">Postprocessing and Plotting solutions</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-120004" id="QQ2-1-14">HyEQ Simulator: A Simulink implementation for simulation of single
and interconnected hybrid systems with or without inputs</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-130004.1" id="QQ2-1-17">The Integrator System</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.1.1 <a 
href="#x1-140004.1.1" id="QQ2-1-19">CT Dynamics</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.1.2 <a 
href="#x1-150004.1.2" id="QQ2-1-21">Jump Logic</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.1.3 <a 
href="#x1-160004.1.3" id="QQ2-1-23">Update Logic</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.1.4 <a 
href="#x1-170004.1.4" id="QQ2-1-25">Stop Logic</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.2 <a 
href="#x1-180004.2" id="QQ2-1-27">Software Requirements</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.1 <a 
href="#x1-190004.2.1" id="QQ2-1-28">Configuration of HyEQ Simulator with embedded functions for Windows</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsubsectionToc" >4.2.2 <a 
href="#x1-200004.2.2" id="QQ2-1-29">Configuration of HyEQ Simulator with embedded functions for Mac/Linux</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.3 <a 
href="#x1-210004.3" id="QQ2-1-30">Configuration of Integration Scheme</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.4 <a 
href="#x1-220004.4" id="QQ2-1-31">Initialization</a></span>
<br />   &#x00A0;<span class="subsectionToc" >4.5 <a 
href="#x1-230004.5" id="QQ2-1-32">Postprocessing and Plotting solutions</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-240005" id="QQ2-1-33">Examples</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-250006" id="QQ2-1-47">Further Reading</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-260007" id="QQ2-1-48">Acknowledgments</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-270008" id="QQ2-1-49">References</a></span>
   </div>
<!--l. 96--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Introduction</h3>
<div class="center" 
>
<!--l. 97--><p class="noindent" >
</p>
<div  
class="centerline"><span class="fbox"></p><!--l. 98--><p class="noindent" >To get started, a webinar introducing the HyEQ Toolbox is available at<br />
<a 
href="http://www.mathworks.com/videos/hyeq-a-toolbox-for-simulation-of-hybrid-dynamical-systems-81992.html" class="url" ><span 
class="cmtt-8">http://www.mathworks.com/videos/hyeq-a-toolbox-for-simulation-of-hybrid-dynamical-systems-81992.html</span></a><br />
A free two-step registration is required by Mathworks.                                            </span></div>-
</div>
<!--l. 104--><p class="noindent" >A hybrid system is a dynamical system with continuous and discrete dynamics. Several mathematical models for
hybrid systems have appeared in literature. In this paper, we consider the framework for hybrid systems used in
[3,4], where a hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>on a state space <span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> with input space <span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">m</span></sup> is defined by the following objects:
</p>
                                                                                         
                                                                                         
     <ul class="itemize1">
     <li class="itemize">A set <span 
class="cmti-10">C </span><span 
class="cmsy-10">&#x2282; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> <span 
class="cmsy-10">&#x00D7; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">m</span></sup> called the <span 
class="cmti-10">flow set</span>.
     </li>
     <li class="itemize">A function <span 
class="cmti-10">f </span>: <span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> <span 
class="cmsy-10">&#x00D7; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">m</span></sup> <span 
class="cmsy-10">&#x2192; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> called the <span 
class="cmti-10">flow map</span>.
     </li>
     <li class="itemize">A set <span 
class="cmti-10">D </span><span 
class="cmsy-10">&#x2282; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> <span 
class="cmsy-10">&#x00D7; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">m</span></sup> called the <span 
class="cmti-10">jump set</span>.
     </li>
     <li class="itemize">A function <span 
class="cmti-10">g </span>: <span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> <span 
class="cmsy-10">&#x00D7; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">m</span></sup> <span 
class="cmsy-10">&#x2192; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmmi-7">n</span></sup> called the <span 
class="cmti-10">jump map</span>.</li></ul>
<!--l. 113--><p class="noindent" >We consider the simulation in MATLAB/Simulink of hybrid systems <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>= (<span 
class="cmmi-10">C,f,D,g</span>) written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v2030x.png" alt="                    {
               m      x&#x02D9;   =  f(x,u)   (x,u) &#x2208; C
H :    x, u &#x2208; &#x211D;       x+   =  g(x,u)   (x,u) &#x2208; D.                    (1)
" class="math-display"  /><a 
 id="x1-2001r1"></a></center>
</div>
<!--l. 124--><p class="indent" >   The flow map <span 
class="cmti-10">f </span>defines the continuous dynamics on the flow set <span 
class="cmti-10">C</span>, while the jump map <span 
class="cmti-10">g </span>defines the discrete
dynamics on the jump set <span 
class="cmti-10">D</span>. These objects are referred to as the <span 
class="cmti-10">data </span>of the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span>, which at times is
explicitly denoted as <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>= (<span 
class="cmmi-10">C,f,D,g</span>). We illustrate this framework in a simple, yet rich in behavior, hybrid
system.
</p>
   <div class="newtheorem">
<!--l. 127--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.1</span> </span>(bouncing ball system) <a 
 id="x1-20021"></a>Consider a model for a bouncing ball written as </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v2031x.png" alt="                 [    ]      {              }
          f(x) :=  x2   ,C :=  x &#x2208; &#x211D;2 | x1 &#x2265; 0                      (2)
       [      ]    - &#x03B3;
g(x) :=    0    ,D := {x &#x2208; &#x211D;2 | x &#x2264; 0 , x &#x2264; 0}                     (3)
         - &#x03BB;x2                  1      2
" class="math-display"  /><a 
 id="x1-2003r2"></a><a 
 id="x1-2003r3"></a></center>
</div>where <span 
class="cmmi-10">&#x03B3; &#x003E; </span>0 is the gravity constant and <span 
class="cmmi-10">&#x03BB; </span><span 
class="cmsy-10">&#x2208; </span>[0<span 
class="cmmi-10">,</span>1) is the restitution coefficient. In this model, we consider the ball to
be bouncing on a floor at a height of 0. This model is re-visited as an example in Section <a 
href="#x1-40003">3<!--tex4ht:ref: sec:litesolver --></a> and Section <a 
href="#x1-240005">5<!--tex4ht:ref: sec:examples --></a>.
                                                                                         _ 
                                                                                         
                                                                                         
   </div>
<!--l. 151--><p class="indent" >   The remainder of this note is organized as follows. In Section <a 
href="#x1-30002">2<!--tex4ht:ref: sec:installation --></a>, we describe how to install the HyEQ Toolbox in
MATLAB. In Section <a 
href="#x1-40003">3<!--tex4ht:ref: sec:litesolver --></a>, we introduce the Lite HyEQ Simulator for solving hybrid systems without inputs. In
Section <a 
href="#x1-120004">4<!--tex4ht:ref: sec:HyEQsimulator --></a>, we introduce the HyEQ Simulator implemented in Simulink for solving single and interconnected hybrid
systems with inputs. In Section <a 
href="#x1-240005">5<!--tex4ht:ref: sec:examples --></a>, we work through several examples for the simulation of single and
interconnected hybrid systems. In Section <a 
href="#x1-250006">6<!--tex4ht:ref: sec:closingremarks --></a>, we give directions to where the simulator files can be
downloaded.
</p><!--l. 156--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Installation</h3>
<!--l. 159--><p class="noindent" >The following procedure describes how to install the Hybrid Equations (HyEQ) Toolbox in MATLAB.
This installation adds useful <span 
class="cmtt-10">.m </span>files to the MATLAB library and several blocks to the Simulink block
library.
</p><!--l. 161--><p class="indent" >   Steps for installation:
</p><!--l. 163--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-3002x1">Download    the    HyEQ    Toolbox    from    MATLAB    Central    or    the    author&#8217;s    website    at
     <a 
href="https://hybrid.soe.ucsc.edu/software" class="url" ><span 
class="cmtt-10">https://hybrid.soe.ucsc.edu/software</span></a>.
     </li>
     <li 
  class="enumerate" id="x1-3004x2">Extract all files and save in any place (except the root folder).
     </li>
     <li 
  class="enumerate" id="x1-3006x3">Open MATLAB and change the current folder to the folder where the <span 
class="cmtt-10">install.m </span>is located.
     </li>
     <li 
  class="enumerate" id="x1-3008x4">Type <span 
class="cmtt-10">install </span>in the command window and hit enter to run the file <span 
class="cmtt-10">install.m</span>.
     </li>
     <li 
  class="enumerate" id="x1-3010x5">Follow the on-screen prompts. Must answer yes to the question:
                                                                                         
                                                                                         
     <div class="verbatim" id="verbatim-1">
     &#x00A0;Add&#x00A0;toolbox&#x00A0;permanently&#x00A0;into&#x00A0;your&#x00A0;startup&#x00A0;path&#x00A0;(highly&#x00A0;recommended)?&#x00A0;Y/E/N&#x00A0;[Y]:&#x00A0;y&#x00A0;
</div>
     <!--l. 168--><p class="nopar" >
     </p></li>
     <li 
  class="enumerate" id="x1-3012x6">Once installation has finished, close and then reopen MATLAB.</li></ol>
<!--l. 172--><p class="indent" >   Now the HyEQ Toolbox is ready for use.
</p><!--l. 174--><p class="indent" >   If you wish to uninstall the HyEQ Toolbox from MATLAB, simply run the <span 
class="cmtt-10">tbclean.m </span>file inside the
 <span 
class="cmtt-10">HyEQ</span><span 
class="cmtt-10">_Toolbox</span><span 
class="cmtt-10">_V2</span><span 
class="cmtt-10">_03</span><span 
class="cmtt-10">&#x00A0;</span>folder, and follow the on-screen prompts.
</p><!--l. 177--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-40003"></a> Lite HyEQ Simulator: A stand-alone MATLAB code for simulation of hybrid systems without
inputs</h3>
<!--l. 179--><p class="noindent" >One way to simulate hybrid systems is to use ODE function calls with events in MATLAB (see, e.g., [2]). Such an
implementation gives fast simulation of a hybrid system.
</p><!--l. 181--><p class="indent" >   In the lite HyEQ solver, four basic functions are used to define the <span 
class="cmti-10">data </span>of the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>as in (<a 
href="#x1-2001r1">1<!--tex4ht:ref: eqn:HS --></a>)
(without inputs): </p>
     <ul class="itemize1">
     <li class="itemize">The flow map is defined in the MATLAB function <span 
class="cmtt-10">f.m</span>. The input to this function is a vector with
     components defining the state of the system <span 
class="cmmi-10">x</span>. Its output is the value of the flow map <span 
class="cmmi-10">f</span>.
     </li>
     <li class="itemize">The flow set is defined in the MATLAB function <span 
class="cmtt-10">C.m</span>. The input to this function is a vector with
     components defining the state of the system <span 
class="cmmi-10">x</span>. Its output is equal to 1 if the state belongs to the set
     <span 
class="cmmi-10">C </span>or equal to 0 otherwise.
     </li>
     <li class="itemize">The jump map is defined in the MATLAB function <span 
class="cmtt-10">g.m</span>. Its input is a vector with components defining
     the state of the system <span 
class="cmmi-10">x</span>. Its output is the value of the jump map <span 
class="cmmi-10">g</span>.
     </li>
     <li class="itemize">The jump set is defined in the MATLAB function <span 
class="cmtt-10">D.m</span>. Its input is a vector with components defining
     the state of the system <span 
class="cmmi-10">x</span>. Its output is equal to 1 if the state belongs to <span 
class="cmmi-10">D </span>or equal to 0 otherwise.</li></ul>
<!--l. 194--><p class="indent" >   Our Lite HyEQ Simulator uses a main function <span 
class="cmtt-10">run.m </span>to initialize, run, and plot solutions for the simulation,
functions <span 
class="cmtt-10">f.m, C.m, g.m, </span>and <span 
class="cmtt-10">D.m </span>to implement the data of the hybrid system, and <span 
class="cmtt-10">HyEQsolver.m </span>which will
solve the differential equations by integrating the continuous dynamics, <span 
class="cmmi-10">&#x1E8B;</span> = <span 
class="cmmi-10">f</span>(<span 
class="cmmi-10">x</span>), and jumping by the
update law <span 
class="cmmi-10">x</span><sup><span 
class="cmr-7">+</span></sup> = <span 
class="cmmi-10">g</span>(<span 
class="cmmi-10">x</span>). The ODE solver called in <span 
class="cmtt-10">HyEQsolver.m </span>initially uses the initial or most recent
step size, and after each integration, the algorithms in <span 
class="cmtt-10">HyEQsolver.m </span>check to see if the solution is
in the set <span 
class="cmmi-10">C</span>, <span 
class="cmmi-10">D</span>, or neither. Depending on which set the solution is in, the simulation is accordingly
reset following the dynamics given in <span 
class="cmmi-10">f </span>or <span 
class="cmmi-10">g</span>, or the simulation is stopped. This implementation is
fast because it also does not store variables to the workspace and only uses built-in ODE function
calls.
</p><!--l. 196--><p class="indent" >   Time and jump horizons are set for the simulation using <span 
class="cmtt-10">TSPAN = [TSTART TFINAL] </span>as the time interval of the
simulation and <span 
class="cmtt-10">JSPAN = [JSTART   JSTOP] </span>as the interval for the number of discrete jumps allowed.
The simulation stops when either the time or jump horizon, i.e. the final value of either interval, is
reached.
</p><!--l. 1--><p class="indent" >   The example below shows how to use the HyEQ solver to simulate a bouncing ball.
                                                                                         
                                                                                         
</p>
   <div class="newtheorem">
<!--l. 3--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.2</span> </span>(bouncing ball with Lite HyEQ Solver) <a 
 id="x1-40012"></a>Consider the hybrid system model for the bouncing
ball with data given in Example&#x00A0;1.1.
</p><!--l. 6--><p class="indent" >   For this example, we consider the ball to be bouncing on a floor at zero height. The constants for the bouncing
ball system are <span 
class="cmmi-10">&#x03B3; </span>= 9<span 
class="cmmi-10">.</span>81 and <span 
class="cmmi-10">&#x03BB; </span>= 0<span 
class="cmmi-10">.</span>8. The following procedure is used to simulate this example in the Lite HyEQ
Solver: </p>
     <ul class="itemize1">
     <li class="itemize">Inside the MATLAB script <span 
class="cmtt-10">run.m</span>, initial conditions, simulation horizons, a rule for jumps, ode solver
     options, and a step size coefficient are defined. The function <span 
class="cmtt-10">HyEQsolver.m </span>is called in order to run
     the simulation, and a script for plotting solutions is included.
     </li>
     <li class="itemize">Then the MATLAB functions <span 
class="cmtt-10">f.m, C.m, g.m, D.m </span>are edited according to the data given above.
     </li>
     <li class="itemize">Finally, the simulation is run by clicking the run button in <span 
class="cmtt-10">run.m </span>or by calling <span 
class="cmtt-10">run.m </span>in the MATLAB
     command window.</li></ul>
<!--l. 14--><p class="indent" >   Example code for each of the MATLAB files <span 
class="cmtt-10">run.m, f.m, C.m, g.m, </span>and <span 
class="cmtt-10">D.m </span>is given below.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;run</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;conditions</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[x1_0;x2_0];</span></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;horizon</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;TSPAN=[0</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">10];</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;JSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[0</span><span 
class="pcrr7t-">&#x00A0;20];</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset(</span></span><span class="verb"><span 
class="pcrr7t-">'RelTol'</span></span><span class="verb"><span 
class="pcrr7t-">,1e-6,</span></span><span class="verb"><span 
class="pcrr7t-">'MaxStep'</span></span><span class="verb"><span 
class="pcrr7t-">,.1);</span></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulate</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[t,j,x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;HyEQsolver(@f,@g,@C,@D,x0,TSPAN,JSPAN,rule,options);</span></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;solution</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(1)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,1))</span></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">21</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">22</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,1))</span></span><br 
class="newline" /><span 
class="cmr-7">23</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">24</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">25</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(2)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;velocity</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">26</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><br 
class="newline" /><span 
class="cmr-7">27</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,2))</span></span><br 
class="newline" /><span 
class="cmr-7">28</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">29</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x2'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">30</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,2))</span></span><br 
class="newline" /><span 
class="cmr-7">31</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">32</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x2'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">33</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;arc</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">34</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(3)</span></span><br 
class="newline" /><span 
class="cmr-7">35</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;plotHybridArc(t,j,x)</span></span><br 
class="newline" /><span 
class="cmr-7">36</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'j'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">37</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'t'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">38</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;zlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">39</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">40</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;view(37.5,30)</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;differential</span><span 
class="pcrr7t-">&#x00A0;equations</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[x2</span><span 
class="pcrr7t-">&#x00A0;;</span><span 
class="pcrr7t-">&#x00A0;-9.81];</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;[value</span><span 
class="pcrr7t-">&#x00A0;discrete]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(x)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;0</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;value</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;value</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[-x1</span><span 
class="pcrr7t-">&#x00A0;;</span><span 
class="pcrr7t-">&#x00A0;-0.8&#x22C6;x2];</span></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;inside</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(x)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(x1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;0</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;x2</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;0)</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;inside</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;inside</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p>
                                                                                         
                                                                                         
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-40041"></a> <a 
 id="x1-4002r1"></a> <img 
src="HyEQ_Toolbox_v2032x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2032x.png" src="figures/Examples/FlowsAndJumps1lite.eps"  
-->
                                       <span 
class="cmr-8">(a) Height</span>
<a 
 id="x1-4003r2"></a> <img 
src="HyEQ_Toolbox_v2033x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2033x.png" src="figures/Examples/FlowsAndJumps2lite.eps"  
-->
                   <span 
class="cmr-8">(b) Velocity</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1: </span><span  
class="content">Solution of Example <a 
href="#x1-40012">1.2<!--tex4ht:ref: ex:bblite --></a></span></div><!--tex4ht:label?: x1-40041 -->
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-40052"></a>
<div class="center" 
>
<!--l. 53--><p class="noindent" >
                                                                                         
                                                                                         
</p><!--l. 57--><p class="noindent" ><img 
src="HyEQ_Toolbox_v2034x.png" alt="PIC" class="graphics" width="375.80544pt" height="282.53006pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2034x.png" src="figures/Examples/HybridArclite.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Hybrid arc corresponding to a solution of Example&#x00A0;<a 
href="#x1-40012">1.2<!--tex4ht:ref: ex:bblite --></a>: height</span></div><!--tex4ht:label?: x1-40052 -->
</div>
   </div><hr class="endfigure" />
<!--l. 63--><p class="indent" >   A solution to the bouncing ball system from <span 
class="cmmi-10">x</span>(0<span 
class="cmmi-10">,</span>0) = [1<span 
class="cmmi-10">,</span>0]<sup><span 
class="cmsy-7">&#x22A4;</span></sup> and with <span 
class="cmmi-10">TSPAN </span>= [0  10]<span 
class="cmmi-10">,JSPAN </span>= [0  20],
<span 
class="cmmi-10">rule </span>= 1, is depicted in Figure&#x00A0;<a 
href="#x1-4002r1">1(a)<!--tex4ht:ref: fig:lite-1 --></a> (height) and Figure&#x00A0;<a 
href="#x1-4003r2">1(b)<!--tex4ht:ref: fig:lite-2 --></a> (velocity). Both the projection onto <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are shown.
Figure&#x00A0;<a 
href="#x1-40052">2<!--tex4ht:ref: fig:lite-3 --></a> depicts the corresponding hybrid arc for the position state.
</p><!--l. 65--><p class="indent" >   For MATLAB files of this example, see Examples/Example_<a 
href="#x1-40012">1.2<!--tex4ht:ref: ex:bblite --></a>.
                                                                                         _ 
</p>
   </div>
<!--l. 201--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-50003.1"></a>Solver Function</h4>
<!--l. 205--><p class="noindent" >The solver function <span 
class="cmtt-10">HyEQsolver </span>solves the hybrid system using three different functions as shown below. First, the
flows are calculated using the built-in ODE solver function ODE45 in MATLAB. If the solution leaves the flow set <span 
class="cmtt-10">C</span>,
the discrete event is detected using the function <span 
class="cmtt-10">zeroevents </span>as shown in Section <a 
href="#x1-60003.1.1">3.1.1<!--tex4ht:ref: sec:eventsdetection --></a>. When the state jumps, the
next value of the state is calculated via the jump map <span 
class="cmtt-10">g </span>using the function <span 
class="cmtt-10">jump </span>as shown in Section
<a 
href="#x1-70003.1.2">3.1.2<!--tex4ht:ref: sec:jumpmap --></a>.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;[t</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;HyEQsolver(f,g,C,D,x0,TSPAN,JSPAN,rule,options,solver)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%HYEQSOLVER</span><span 
class="pcrr7t-">&#x00A0;solves</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;equations.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Syntax:</span><span 
class="pcrr7t-">&#x00A0;[t</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER(f,g,C,D,x0,TSPAN,JSPAN,rule,options,solver)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;computes</span><span 
class="pcrr7t-">&#x00A0;solutions</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;equations</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;\dot{x}</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x,t,j)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x</span><span 
class="pcrr7t-">&#x00A0;\in</span><span 
class="pcrr7t-">&#x00A0;C</span><span 
class="pcrr7t-">&#x00A0;x^+</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x,t,j)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x</span><span 
class="pcrr7t-">&#x00A0;\in</span><span 
class="pcrr7t-">&#x00A0;D</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;where</span><span 
class="pcrr7t-">&#x00A0;x</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;state,</span><span 
class="pcrr7t-">&#x00A0;f</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map,</span><span 
class="pcrr7t-">&#x00A0;g</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map,</span><span 
class="pcrr7t-">&#x00A0;C</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set,</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;D</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set.</span><span 
class="pcrr7t-">&#x00A0;It</span><span 
class="pcrr7t-">&#x00A0;outputs</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;state</span><span 
class="pcrr7t-">&#x00A0;trajectory</span><span 
class="pcrr7t-">&#x00A0;(t,j)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;x(t,j),</span><span 
class="pcrr7t-">&#x00A0;where</span><span 
class="pcrr7t-">&#x00A0;t</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;time</span><span 
class="pcrr7t-">&#x00A0;parameter</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;parameter.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;defines</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;condition</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;state.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;TSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[TSTART</span><span 
class="pcrr7t-">&#x00A0;TFINAL]</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;time</span><span 
class="pcrr7t-">&#x00A0;interval.</span><span 
class="pcrr7t-">&#x00A0;JSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[JSTART</span><span 
class="pcrr7t-">&#x00A0;JSTOP]</span><span 
class="pcrr7t-">&#x00A0;is</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;interval</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;discrete</span><span 
class="pcrr7t-">&#x00A0;jumps.</span><span 
class="pcrr7t-">&#x00A0;The</span><span 
class="pcrr7t-">&#x00A0;algorithm</span><span 
class="pcrr7t-">&#x00A0;stop</span><span 
class="pcrr7t-">&#x00A0;when</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;first</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;stop</span><span 
class="pcrr7t-">&#x00A0;condition</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;reached.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;(optinal</span><span 
class="pcrr7t-">&#x00A0;parameter)</span><span 
class="pcrr7t-">&#x00A0;-</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;(default)</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">21</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">22</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">23</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;(optinal</span><span 
class="pcrr7t-">&#x00A0;parameter)</span><span 
class="pcrr7t-">&#x00A0;-</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;solver</span><span 
class="pcrr7t-">&#x00A0;see</span><span 
class="pcrr7t-">&#x00A0;odeset</span><span 
class="pcrr7t-">&#x00A0;f.ex.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">24</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset('RelTol',1e-6);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">25</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset('InitialStep',eps);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">26</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">27</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;solver</span><span 
class="pcrr7t-">&#x00A0;(optinal</span><span 
class="pcrr7t-">&#x00A0;parameter.</span><span 
class="pcrr7t-">&#x00A0;String)</span><span 
class="pcrr7t-">&#x00A0;-</span><span 
class="pcrr7t-">&#x00A0;selection</span><span 
class="pcrr7t-">&#x00A0;of</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;desired</span><span 
class="pcrr7t-">&#x00A0;ode</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">28</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;solver.</span><span 
class="pcrr7t-">&#x00A0;All</span><span 
class="pcrr7t-">&#x00A0;ode</span><span 
class="pcrr7t-">&#x00A0;solvers</span><span 
class="pcrr7t-">&#x00A0;are</span><span 
class="pcrr7t-">&#x00A0;suported,</span><span 
class="pcrr7t-">&#x00A0;exept</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;ode15i.</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;See</span><span 
class="pcrr7t-">&#x00A0;help</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">29</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;odeset</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;detailed</span><span 
class="pcrr7t-">&#x00A0;information.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">30</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">31</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Example:</span><span 
class="pcrr7t-">&#x00A0;Bouncing</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;with</span><span 
class="pcrr7t-">&#x00A0;Lite</span><span 
class="pcrr7t-">&#x00A0;HyEQ</span><span 
class="pcrr7t-">&#x00A0;Solver</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">32</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">33</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Consider</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;system</span><span 
class="pcrr7t-">&#x00A0;model</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;bouncing</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;with</span><span 
class="pcrr7t-">&#x00A0;data</span><span 
class="pcrr7t-">&#x00A0;given</span><span 
class="pcrr7t-">&#x00A0;in</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">34</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Example</span><span 
class="pcrr7t-">&#x00A0;1.2.</span><span 
class="pcrr7t-">&#x00A0;For</span><span 
class="pcrr7t-">&#x00A0;this</span><span 
class="pcrr7t-">&#x00A0;example,</span><span 
class="pcrr7t-">&#x00A0;we</span><span 
class="pcrr7t-">&#x00A0;consider</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;be</span><span 
class="pcrr7t-">&#x00A0;bouncing</span><span 
class="pcrr7t-">&#x00A0;on</span><span 
class="pcrr7t-">&#x00A0;a</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">35</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;floor</span><span 
class="pcrr7t-">&#x00A0;at</span><span 
class="pcrr7t-">&#x00A0;zero</span><span 
class="pcrr7t-">&#x00A0;height.</span><span 
class="pcrr7t-">&#x00A0;The</span><span 
class="pcrr7t-">&#x00A0;constants</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;bouncing</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;system</span><span 
class="pcrr7t-">&#x00A0;are</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">36</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;\gamma=9.81</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;\lambda=0.8.</span><span 
class="pcrr7t-">&#x00A0;The</span><span 
class="pcrr7t-">&#x00A0;following</span><span 
class="pcrr7t-">&#x00A0;procedure</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;used</span><span 
class="pcrr7t-">&#x00A0;to</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">37</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;simulate</span><span 
class="pcrr7t-">&#x00A0;this</span><span 
class="pcrr7t-">&#x00A0;example</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;Lite</span><span 
class="pcrr7t-">&#x00A0;HyEQ</span><span 
class="pcrr7t-">&#x00A0;Solver:</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">38</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">39</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;&#x22C6;</span><span 
class="pcrr7t-">&#x00A0;Inside</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;MATLAB</span><span 
class="pcrr7t-">&#x00A0;script</span><span 
class="pcrr7t-">&#x00A0;run_ex1_2.m,</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;conditions,</span><span 
class="pcrr7t-">&#x00A0;simulation</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">40</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;horizons,</span><span 
class="pcrr7t-">&#x00A0;a</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps,</span><span 
class="pcrr7t-">&#x00A0;ode</span><span 
class="pcrr7t-">&#x00A0;solver</span><span 
class="pcrr7t-">&#x00A0;options,</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;a</span><span 
class="pcrr7t-">&#x00A0;step</span><span 
class="pcrr7t-">&#x00A0;size</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">41</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;coefficient</span><span 
class="pcrr7t-">&#x00A0;are</span><span 
class="pcrr7t-">&#x00A0;defined.</span><span 
class="pcrr7t-">&#x00A0;The</span><span 
class="pcrr7t-">&#x00A0;function</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER.m</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;called</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;order</span><span 
class="pcrr7t-">&#x00A0;to</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">42</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;run</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;simulation,</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;a</span><span 
class="pcrr7t-">&#x00A0;script</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;plotting</span><span 
class="pcrr7t-">&#x00A0;solutions</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;included.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">43</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;&#x22C6;</span><span 
class="pcrr7t-">&#x00A0;Then</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;MATLAB</span><span 
class="pcrr7t-">&#x00A0;functions</span><span 
class="pcrr7t-">&#x00A0;f_ex1_2.m,</span><span 
class="pcrr7t-">&#x00A0;C_ex1_2.m,</span><span 
class="pcrr7t-">&#x00A0;g_ex1_2.m,</span><span 
class="pcrr7t-">&#x00A0;D_ex1_2.m</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">44</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;are</span><span 
class="pcrr7t-">&#x00A0;edited</span><span 
class="pcrr7t-">&#x00A0;according</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;data</span><span 
class="pcrr7t-">&#x00A0;given</span><span 
class="pcrr7t-">&#x00A0;below.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">45</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;&#x22C6;</span><span 
class="pcrr7t-">&#x00A0;Finally,</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;run</span><span 
class="pcrr7t-">&#x00A0;by</span><span 
class="pcrr7t-">&#x00A0;clicking</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;run</span><span 
class="pcrr7t-">&#x00A0;button</span><span 
class="pcrr7t-">&#x00A0;in</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">46</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;run_ex1_2.m</span><span 
class="pcrr7t-">&#x00A0;or</span><span 
class="pcrr7t-">&#x00A0;by</span><span 
class="pcrr7t-">&#x00A0;calling</span><span 
class="pcrr7t-">&#x00A0;run_ex1_2.m</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;MATLAB</span><span 
class="pcrr7t-">&#x00A0;command</span><span 
class="pcrr7t-">&#x00A0;window.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">47</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">48</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;For</span><span 
class="pcrr7t-">&#x00A0;further</span><span 
class="pcrr7t-">&#x00A0;information,</span><span 
class="pcrr7t-">&#x00A0;type</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;command</span><span 
class="pcrr7t-">&#x00A0;window:</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">49</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;helpview(['Example_1_2.html']);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">50</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">51</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Define</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;conditions</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">52</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">53</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">54</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[x1_0;</span><span 
class="pcrr7t-">&#x00A0;x2_0];</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">55</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">56</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Set</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;horizon</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">57</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;TSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[0</span><span 
class="pcrr7t-">&#x00A0;10];</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">58</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;JSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[0</span><span 
class="pcrr7t-">&#x00A0;20];</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">59</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">60</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Set</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;ODE</span><span 
class="pcrr7t-">&#x00A0;solver</span><span 
class="pcrr7t-">&#x00A0;options</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">61</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">62</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">63</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">64</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">65</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">66</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;set</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;maximum</span><span 
class="pcrr7t-">&#x00A0;step</span><span 
class="pcrr7t-">&#x00A0;length.</span><span 
class="pcrr7t-">&#x00A0;At</span><span 
class="pcrr7t-">&#x00A0;each</span><span 
class="pcrr7t-">&#x00A0;run</span><span 
class="pcrr7t-">&#x00A0;of</span><span 
class="pcrr7t-">&#x00A0;the</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">67</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;integrator</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;option</span><span 
class="pcrr7t-">&#x00A0;'MaxStep'</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;set</span><span 
class="pcrr7t-">&#x00A0;to</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">68</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;(time</span><span 
class="pcrr7t-">&#x00A0;length</span><span 
class="pcrr7t-">&#x00A0;of</span><span 
class="pcrr7t-">&#x00A0;last</span><span 
class="pcrr7t-">&#x00A0;integration)&#x22C6;maxStepCoefficient.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">69</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Default</span><span 
class="pcrr7t-">&#x00A0;value</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0.1</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">70</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">71</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">72</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">73</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset('RelTol',1e-6,'MaxStep',.1);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">74</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">75</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Simulate</span><span 
class="pcrr7t-">&#x00A0;using</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER</span><span 
class="pcrr7t-">&#x00A0;script</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">76</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;Given</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;matlab</span><span 
class="pcrr7t-">&#x00A0;functions</span><span 
class="pcrr7t-">&#x00A0;that</span><span 
class="pcrr7t-">&#x00A0;models</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map,</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map,</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">77</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span><span 
class="pcrr7t-">&#x00A0;(f_ex1_2,</span><span 
class="pcrr7t-">&#x00A0;g_ex1_2,</span><span 
class="pcrr7t-">&#x00A0;C_ex1_2,</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;D_ex1_2</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">78</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;respectively)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">79</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">80</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[t</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER(</span><span 
class="pcrr7t-">&#x00A0;@f_ex1_2,@g_ex1_2,@C_ex1_2,@D_ex1_2,...</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">81</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0,TSPAN,JSPAN,rule,options,'ode45');</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">82</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">83</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;solution</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">84</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">85</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(1)</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">86</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">87</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,1))</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">88</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">89</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x1')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">90</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">91</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,1))</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">92</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">93</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x1')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">94</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">95</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(2)</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;velocity</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">96</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">97</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,2))</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">98</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">99</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x2')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">100</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">101</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,2))</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">102</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">103</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x2')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">104</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">105</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;arc</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">106</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">107</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(3)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">108</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;plotHybridArc(t,j,x)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">109</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xlabel('j')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">110</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('t')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">111</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;zlabel('x1')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">112</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">113</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;solution</span><span 
class="pcrr7t-">&#x00A0;using</span><span 
class="pcrr7t-">&#x00A0;plotHarc</span><span 
class="pcrr7t-">&#x00A0;and</span><span 
class="pcrr7t-">&#x00A0;plotHarcColor</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">114</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">115</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(4)</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">116</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">117</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),</span><span 
class="pcrr7t-">&#x00A0;plotHarc(t,j,x(:,1));</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">118</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">119</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x_1</span><span 
class="pcrr7t-">&#x00A0;position')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">120</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),</span><span 
class="pcrr7t-">&#x00A0;plotHarc(t,j,x(:,2));</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">121</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">122</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x_2</span><span 
class="pcrr7t-">&#x00A0;velocity')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">123</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">124</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">125</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;a</span><span 
class="pcrr7t-">&#x00A0;phase</span><span 
class="pcrr7t-">&#x00A0;plane</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">126</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(5)</span><span 
class="pcrr7t-">&#x00A0;%</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">127</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">128</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;plotHarcColor(x(:,1),j,x(:,2),t);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">129</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xlabel('x_1')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">130</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel('x_2')</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">131</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">132</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">133</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%--------------------------------------------------------------------------</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">134</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Matlab</span><span 
class="pcrr7t-">&#x00A0;M-file</span><span 
class="pcrr7t-">&#x00A0;Project:</span><span 
class="pcrr7t-">&#x00A0;HyEQ</span><span 
class="pcrr7t-">&#x00A0;Toolbox</span><span 
class="pcrr7t-">&#x00A0;@</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Hybrid</span><span 
class="pcrr7t-">&#x00A0;Systems</span><span 
class="pcrr7t-">&#x00A0;Laboratory</span><span 
class="pcrr7t-">&#x00A0;(HSL),</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">135</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;https://hybrid.soe.ucsc.edu/software</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">136</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;http://hybridsimulator.wordpress.com/</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">137</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Filename:</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER.m</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">138</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%--------------------------------------------------------------------------</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">139</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;See</span><span 
class="pcrr7t-">&#x00A0;also</span><span 
class="pcrr7t-">&#x00A0;HYEQSOLVER,</span><span 
class="pcrr7t-">&#x00A0;PLOTARC,</span><span 
class="pcrr7t-">&#x00A0;PLOTARC3,</span><span 
class="pcrr7t-">&#x00A0;PLOTFLOWS,</span><span 
class="pcrr7t-">&#x00A0;PLOTHARC,</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">140</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;PLOTHARCCOLOR,</span><span 
class="pcrr7t-">&#x00A0;PLOTHARCCOLOR3D,</span><span 
class="pcrr7t-">&#x00A0;PLOTHYBRIDARC,</span><span 
class="pcrr7t-">&#x00A0;PLOTJUMPS.</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">141</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Copyright</span><span 
class="pcrr7t-">&#x00A0;@</span><span 
class="pcrr7t-">&#x00A0;Hybrid</span><span 
class="pcrr7t-">&#x00A0;Systems</span><span 
class="pcrr7t-">&#x00A0;Laboratory</span><span 
class="pcrr7t-">&#x00A0;(HSL),</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">142</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;Revision:</span><span 
class="pcrr7t-">&#x00A0;0.0.0.3</span><span 
class="pcrr7t-">&#x00A0;Date:</span><span 
class="pcrr7t-">&#x00A0;04/7/2016</span><span 
class="pcrr7t-">&#x00A0;11:50:00</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">143</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">144</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">145</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;~exist(</span></span><span class="verb"><span 
class="pcrr7t-">'rule'</span></span><span class="verb"><span 
class="pcrr7t-">,</span></span><span class="verb"><span 
class="pcrr7t-">'var'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">146</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">147</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">148</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">149</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;~exist(</span></span><span class="verb"><span 
class="pcrr7t-">'options'</span></span><span class="verb"><span 
class="pcrr7t-">,</span></span><span class="verb"><span 
class="pcrr7t-">'var'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">150</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset();</span></span><br 
class="newline" /><span 
class="cmr-7">151</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">152</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">153</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;~exist(</span></span><span class="verb"><span 
class="pcrr7t-">'solver'</span></span><span class="verb"><span 
class="pcrr7t-">,</span></span><span class="verb"><span 
class="pcrr7t-">'var'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">154</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;solver</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">'ode45'</span></span><span class="verb"><span 
class="pcrr7t-">;</span></span><br 
class="newline" /><span 
class="cmr-7">155</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">156</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">157</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;odeX</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;str2func(solver);</span></span><br 
class="newline" /><span 
class="cmr-7">158</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;nargf</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;nargin(f);</span></span><br 
class="newline" /><span 
class="cmr-7">159</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;nargg</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;nargin(g);</span></span><br 
class="newline" /><span 
class="cmr-7">160</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;nargC</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;nargin(C);</span></span><br 
class="newline" /><span 
class="cmr-7">161</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;nargD</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;nargin(D);</span></span><br 
class="newline" /><span 
class="cmr-7">162</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">163</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">164</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">165</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;horizon</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">166</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tstart</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;TSPAN(1);</span></span><br 
class="newline" /><span 
class="cmr-7">167</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tfinal</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;TSPAN(end);</span></span><br 
class="newline" /><span 
class="cmr-7">168</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;JSPAN(1);</span></span><br 
class="newline" /><span 
class="cmr-7">169</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jout(end);</span></span><br 
class="newline" /><span 
class="cmr-7">170</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">171</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulate</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">172</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;tstart;</span></span><br 
class="newline" /><span 
class="cmr-7">173</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[rx,cx]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;size(x0);</span></span><br 
class="newline" /><span 
class="cmr-7">174</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;rx</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">175</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x0;</span></span><br 
class="newline" /><span 
class="cmr-7">176</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">elseif</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;cx</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">177</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x0.';</span></span><br 
class="newline" /><span 
class="cmr-7">178</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">179</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;error(</span></span><span class="verb"><span 
class="pcrr7t-">'Error,</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;does</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;have</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;proper</span><span 
class="pcrr7t-">&#x00A0;size'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">180</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">181</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">182</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Jump</span><span 
class="pcrr7t-">&#x00A0;if</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;prioritized:</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">183</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">184</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">while</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(j&#x003C;JSPAN(end))</span></span><br 
class="newline" /><span 
class="cmr-7">185</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Check</span><span 
class="pcrr7t-">&#x00A0;if</span><span 
class="pcrr7t-">&#x00A0;value</span><span 
class="pcrr7t-">&#x00A0;it</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;possible</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;current</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">186</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(xout(end,:).',tout(end),j,D,nargD);</span></span><br 
class="newline" /><span 
class="cmr-7">187</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">188</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[j</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">tout</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;xout]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jump(g,j,tout,jout,xout,nargg);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">189</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">190</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;break;</span></span><br 
class="newline" /><span 
class="cmr-7">191</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">192</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">193</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">194</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;fprintf(</span></span><span class="verb"><span 
class="pcrr7t-">'Completed:</span><span 
class="pcrr7t-">&#x00A0;%3.0f%%'</span></span><span class="verb"><span 
class="pcrr7t-">,0);</span></span><br 
class="newline" /><span 
class="cmr-7">195</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">while</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(j</span><span 
class="pcrr7t-">&#x00A0;&#x003C;</span><span 
class="pcrr7t-">&#x00A0;JSPAN(end)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;tout(end)</span><span 
class="pcrr7t-">&#x00A0;&#x003C;</span><span 
class="pcrr7t-">&#x00A0;TSPAN(end))</span></span><br 
class="newline" /><span 
class="cmr-7">196</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset(options,</span></span><span class="verb"><span 
class="pcrr7t-">'Events'</span></span><span class="verb"><span 
class="pcrr7t-">,@(t,x)</span><span 
class="pcrr7t-">&#x00A0;zeroevents(x,t,j,C,D,...</span></span><br 
class="newline" /><span 
class="cmr-7">197</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule,nargC,nargD));</span></span><br 
class="newline" /><span 
class="cmr-7">198</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Check</span><span 
class="pcrr7t-">&#x00A0;if</span><span 
class="pcrr7t-">&#x00A0;it</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;possible</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;from</span><span 
class="pcrr7t-">&#x00A0;current</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">199</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideC</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(xout(end,:).',tout(end),j,C,nargC);</span></span><br 
class="newline" /><span 
class="cmr-7">200</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;insideC</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">201</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[t,x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeX(@(t,x)</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(x,t,j,f,nargf),[tout(end)</span><span 
class="pcrr7t-">&#x00A0;tfinal],...</span></span><br 
class="newline" /><span 
class="cmr-7">202</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xout(end,:).',</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">options);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">203</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;nt</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;length(t);</span></span><br 
class="newline" /><span 
class="cmr-7">204</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[tout;</span><span 
class="pcrr7t-">&#x00A0;t];</span></span><br 
class="newline" /><span 
class="cmr-7">205</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xout;</span><span 
class="pcrr7t-">&#x00A0;x];</span></span><br 
class="newline" /><span 
class="cmr-7">206</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[jout;</span><span 
class="pcrr7t-">&#x00A0;j&#x22C6;ones(1,nt)'];</span></span><br 
class="newline" /><span 
class="cmr-7">207</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">208</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">209</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%Check</span><span 
class="pcrr7t-">&#x00A0;if</span><span 
class="pcrr7t-">&#x00A0;it</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;possible</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">210</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(xout(end,:).',tout(end),j,D,nargD);</span></span><br 
class="newline" /><span 
class="cmr-7">211</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;0</span></span><br 
class="newline" /><span 
class="cmr-7">212</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;break;</span></span><br 
class="newline" /><span 
class="cmr-7">213</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">214</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">215</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">while</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(j&#x003C;JSPAN(end))</span></span><br 
class="newline" /><span 
class="cmr-7">216</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Check</span><span 
class="pcrr7t-">&#x00A0;if</span><span 
class="pcrr7t-">&#x00A0;it</span><span 
class="pcrr7t-">&#x00A0;is</span><span 
class="pcrr7t-">&#x00A0;possible</span><span 
class="pcrr7t-">&#x00A0;to</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;from</span><span 
class="pcrr7t-">&#x00A0;current</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">217</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(xout(end,:).',tout(end),j,D,nargD);</span></span><br 
class="newline" /><span 
class="cmr-7">218</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">219</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[j</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">tout</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;xout]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jump(g,j,tout,jout,xout,nargg);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">220</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">221</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;break;</span></span><br 
class="newline" /><span 
class="cmr-7">222</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">223</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">224</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">225</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[j</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">tout</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;xout]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jump(g,j,tout,jout,xout,nargg);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">226</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">227</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">228</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;fprintf(</span></span><span class="verb"><span 
class="pcrr7t-">'\b\b\b\b%3.0f%%'</span></span><span class="verb"><span 
class="pcrr7t-">,max(100&#x22C6;j/JSPAN(end),100&#x22C6;tout(end)/TSPAN(end)));</span></span><br 
class="newline" /><span 
class="cmr-7">229</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">230</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;t</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;tout;</span></span><br 
class="newline" /><span 
class="cmr-7">231</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xout;</span></span><br 
class="newline" /><span 
class="cmr-7">232</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jout;</span></span><br 
class="newline" /><span 
class="cmr-7">233</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;fprintf(</span></span><span class="verb"><span 
class="pcrr7t-">'\nDone\n'</span></span><span class="verb"><span 
class="pcrr7t-">);</span></span><br 
class="newline" /><span 
class="cmr-7">234</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">235</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" />
</p><!--l. 209--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.1.1   </span> <a 
 id="x1-60003.1.1"></a>Events Detection</h5>
<!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;[value,isterminal,direction]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;zeroevents(x,t,j,C,D,rule,nargC,nargD)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">switch</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;rule</span></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">case</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(1)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;InsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(2)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Inside(C</span><span 
class="pcrr7t-">&#x00A0;\cap</span><span 
class="pcrr7t-">&#x00A0;D)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(3)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;OutsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(1)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;InsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(2)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Inside(C</span><span 
class="pcrr7t-">&#x00A0;\cap</span><span 
class="pcrr7t-">&#x00A0;D)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(3)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;OutsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">case</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%(default)</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(1)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;InsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(2)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Inside(C</span><span 
class="pcrr7t-">&#x00A0;\cap</span><span 
class="pcrr7t-">&#x00A0;D)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;isterminal(3)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;OutsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(1)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;InsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(2)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Inside(C</span><span 
class="pcrr7t-">&#x00A0;\cap</span><span 
class="pcrr7t-">&#x00A0;D)</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;direction(3)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;OutsideC</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideC</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(x,t,j,C,nargC);</span></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;insideD</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(x,t,j,D,nargD);</span></span><br 
class="newline" /><span 
class="cmr-7">21</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;outsideC</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-fun_wrap(x,t,j,C,nargC);</span></span><br 
class="newline" /><span 
class="cmr-7">22</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">23</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">24</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;value(1)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2&#x22C6;insideC;</span></span><br 
class="newline" /><span 
class="cmr-7">25</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;value(2)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2-insideC</span><span 
class="pcrr7t-">&#x00A0;-</span><span 
class="pcrr7t-">&#x00A0;insideD;</span></span><br 
class="newline" /><span 
class="cmr-7">26</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;value(3)</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2&#x22C6;outsideC;</span></span><br 
class="newline" /><span 
class="cmr-7">27</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">28</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">29</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" />
</p><!--l. 214--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">3.1.2   </span> <a 
 id="x1-70003.1.2"></a>Jump Map</h5>
<!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;[j</span><span 
class="pcrr7t-">&#x00A0;tout</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;xout]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;jump(g,j,tout,jout,xout,nargfun)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;j</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;j+1;</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;fun_wrap(xout(end,:).',tout(end),jout(end),g,nargfun);</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;Save</span><span 
class="pcrr7t-">&#x00A0;results</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[tout;</span><span 
class="pcrr7t-">&#x00A0;tout(end)];</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xout;</span><span 
class="pcrr7t-">&#x00A0;y.'];</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;jout</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[jout;</span><span 
class="pcrr7t-">&#x00A0;j];</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><br 
class="newline" />
</p><!--l. 219--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-80003.2"></a>Software Requirements</h4>
<!--l. 221--><p class="noindent" >In order to run simulations using the Lite HyEQ Simulator, MATLAB R13 or newer is required.
</p><!--l. 223--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-90003.3"></a>Configuration of Solver</h4>
<!--l. 225--><p class="noindent" >Before a simulation is started, it is important to determine the needed integrator scheme, zero-cross detection
settings, precision, and other tolerances. Using the default settings does not always give the most efficient or
most accurate simulations. In the Lite HyEQ Simulator, these parameters are edited in the <span 
class="cmtt-10">run.m </span>file
using
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-2">
&#x00A0;options&#x00A0;=&#x00A0;odeset(RelTol,1e-6,MaxStep&#x00A0;,.1);.&#x00A0;
</div>
<!--l. 228--><p class="nopar" >
</p><!--l. 230--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-100003.4"></a>Initialization</h4>
<!--l. 234--><p class="noindent" >The Lite HyEQ Simulator is initialized and run by calling the function <span 
class="cmtt-10">run.m</span>. Inside <span 
class="cmtt-10">run.m</span>, the initial conditions,
simulation horizons <span 
class="cmtt-10">TSPAN </span>and <span 
class="cmtt-10">JSPAN</span>, a rule for jumps, and simulation tolerances are defined. After all of the
parameters are defined, the function <span 
class="cmtt-10">HyEQsolver </span>is called, and the simulation runs. See below for sample code to
initialize and run the bouncing ball example, Example &#x00A0;<a 
href="#x1-40012">1.2<!--tex4ht:ref: ex:bblite --></a>.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;conditions</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2_0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[x1_0;x2_0];</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;horizon</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;TSPAN=[0,10];</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;JSPAN</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[0,20];</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;options</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;odeset(</span></span><span class="verb"><span 
class="pcrr7t-">'RelTol'</span></span><span class="verb"><span 
class="pcrr7t-">,1e-6,</span></span><span class="verb"><span 
class="pcrr7t-">'MaxStep'</span></span><span class="verb"><span 
class="pcrr7t-">,.1);</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulate</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;[t,j,x]</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;HyEQsolver(@f,@g,@C,@D,x0,TSPAN,JSPAN,rule,options);</span></span><br 
class="newline" />
</p><!--l. 239--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-110003.5"></a>Postprocessing and Plotting solutions</h4>
<!--l. 241--><p class="noindent" >The function <span 
class="cmtt-10">run.m </span>is also used to plot solutions after the simulations is complete. See below for sample code to plot
solutions to the bouncing ball example, Example <a 
href="#x1-40012">1.2<!--tex4ht:ref: ex:bblite --></a>.
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;solution</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(1)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,1))</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,1))</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(2)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;velocity</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x(:,2))</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x2'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x(:,2))</span></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x2'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;arc</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(2)</span></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;plotHybridArc(t,j,x)</span></span><br 
class="newline" /><span 
class="cmr-7">21</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'j'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">22</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'t'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">23</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;zlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x1'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">24</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">25</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;view(37.5,30)</span></span><br 
class="newline" />
</p><!--l. 246--><p class="noindent" >The following functions are used to generate the plots: </p>
     <ul class="itemize1">
     <li class="itemize">plotarc(t,j,x,L,jstar,modificatorF,modificatorJ,resolution,DDD,true3D): plots the hybrid time domain
     (matrix) (<span 
class="cmmi-10">t,j</span>) versus the sate <span 
class="cmmi-10">x </span>(matrix) taking into account jumps <span 
class="cmmi-10">j</span>. If <span 
class="cmmi-10">x </span>is a matrix (<span 
class="cmmi-10">n </span>states), then
     the hybrid time is plotted versus the rows or columns of the matrix, whichever line up. If <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j</span>
     are a matrices, then each column of <span 
class="cmmi-10">x </span>will be plotted according to the hybrid time domain composed
     for each column of <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j</span>. Depending on the input data, this function is capable of plotting several
     types of figures, e.g., 2D, 3D, hybrid arcs with color, etc. Next, we list several functions that specialize
     different types of plotting styles from plotarc. For more information, please type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotarc or
     <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotarc in the command window.
     </li>
     <li class="itemize">plotarc3(t,j,x,L,jstar,modificatorF,modificatorJ,resolution,true3D)   is   a   version   of   plotarc   that
     specializes in figures in 3D. For more information, please type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotarc3 or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotarc3
     in the command window.
     </li>
     <li class="itemize">plotflows(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): plots (in blue) the projection of the trajectory <span 
class="cmmi-10">x </span>onto the flow time axis <span 
class="cmmi-10">t</span>. The
     value of the trajectory for intervals [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] with empty interior is marked with <span 
class="cmsy-10">* </span>(in blue). Dashed lines (in
     red) connect the value of the trajectory before and after the jump. Figure&#x00A0;<a 
href="#x1-24003r1">10(a)<!--tex4ht:ref: fig:input-1 --></a> shows a plot created with this
     function.
         <ul class="itemize2">
         <li class="itemize">plotflows(t,j,x,<span 
class="cmmi-10">jstar</span>): The plot is cut regarding the <span 
class="cmmi-10">jstar </span>interval (<span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j </span><span 
class="cmsy-10">-</span><span 
class="cmmi-10">initialj </span><span 
class="cmsy-10">-</span><span 
class="cmmi-10">final</span>]).
         </li>
         <li class="itemize">plotflows(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): Also, a maximum resolution in between jumps is given by the
         input variable resolution</li></ul>
     </li>
     <li class="itemize">plotjumps(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): plots (in red) the projection of the trajectory <span 
class="cmmi-10">x </span>onto the jump time <span 
class="cmmi-10">j</span>. The
     initial and final value of the trajectory on each interval [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] is denoted by <span 
class="cmsy-10">* </span>(in red) and the continuous
     evolution of the trajectory on each interval is depicted with a dashed line (in blue). Figure&#x00A0;<a 
href="#x1-24003r1">10(a)<!--tex4ht:ref: fig:input-1 --></a> shows a plot
     created with this function.
         <ul class="itemize2">
         <li class="itemize">plotjumps(t,j,x,<span 
class="cmmi-10">jstar</span>): The plot is cut regarding the <span 
class="cmmi-10">jstar </span>interval (<span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><span 
class="cmsy-10">-</span><span 
class="cmmi-10">initialj</span><span 
class="cmsy-10">-</span><span 
class="cmmi-10">final</span>]).
         </li>
         <li class="itemize">plotjumps(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): Also, a maximum resolution in between jumps is given by the
         input variable resolution</li></ul>
     </li>
     <li class="itemize">plotHybridArc(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): plots (in blue and red) the trajectory <span 
class="cmmi-10">x </span>on hybrid time domains. The
     intervals [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] indexed by the corresponding <span 
class="cmmi-10">j </span>are depicted in the <span 
class="cmmi-10">t</span><span 
class="cmsy-10">-</span><span 
class="cmmi-10">j </span>plane (in red). Figure&#x00A0;<a 
href="#x1-2400611">11<!--tex4ht:ref: fig:input-3 --></a> shows a
     plot created with this function.
                                                                                         
                                                                                         
         <ul class="itemize2">
         <li class="itemize">plotHybridArc(t,j,x,<span 
class="cmmi-10">jstar</span>): The plot is cut regarding the <span 
class="cmmi-10">jstar </span>interval (<span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j </span><span 
class="cmsy-10">- </span><span 
class="cmmi-10">initialj </span><span 
class="cmsy-10">-</span>
         <span 
class="cmmi-10">final</span>]).
         </li>
         <li class="itemize">plotHybridArc(t,j,x,<span 
class="cmmi-10">jstar</span>,resolution): Also, a maximum resolution in between jumps is given by
         the input variable resolution</li></ul>
     </li>
     <li class="itemize">plotHarc(t,j,x,<span 
class="cmmi-10">jstar</span>,modificatorF,modificatorJ,resolution) is a function for plotting hybrid arcs (n
     states).
         <ul class="itemize2">
         <li class="itemize">plotHarc(t,j,x): plots the trajectory <span 
class="cmmi-10">x </span>versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>). If <span 
class="cmmi-10">x </span>is a matrix, then
         the time vector is plotted versus the rows or columns of the matrix, whichever line up.
         </li>
         <li class="itemize">plotHarc(t,j,x,<span 
class="cmmi-10">jstar</span>): plots the trajectory <span 
class="cmmi-10">x </span>versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>), and the plot is
         cut regarding the <span 
class="cmmi-10">jstar </span>interval (<span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>]).
         </li>
         <li class="itemize">plotHarc(t,j,x,<span 
class="cmmi-10">jstar</span>,modificatorF,modificatorJ):  ModificatorF  and  ModificatorJ  are  cell  arrays
         that contains the standard matlab ploting modificators (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarc or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin
         plotHarc in the command window for more information).</li></ul>
     </li>
     <li class="itemize">plotHarcColor(t,j,x,L,<span 
class="cmmi-10">jstar</span>,resolution) plots the trajectory <span 
class="cmmi-10">x </span>on hybrid time domain with color.
         <ul class="itemize2">
         <li class="itemize">plotHarcColor(t,j,x,L): plots the trajectory <span 
class="cmmi-10">x </span>(vector) versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>). The
         hybrid arc is plotted with <span 
class="cmmi-10">L </span>data as color. The input vectors <span 
class="cmmi-10">t,</span><span 
class="cmmi-10">&#x00A0;j,</span><span 
class="cmmi-10">&#x00A0;x,</span><span 
class="cmmi-10">&#x00A0;L </span>must have the same
         length.
         </li>
         <li class="itemize">plotHarcColor(t,j,x,L,<span 
class="cmmi-10">jstar</span>): If a specific interval in <span 
class="cmmi-10">j </span>is required, <span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>] must be
         provided. (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarcColor or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotHarcColor in the command window
         for more information)</li></ul>
     </li>
     <li class="itemize">plotHarcColor3D(t,j,x,L,<span 
class="cmmi-10">jstar</span>,modificator,resolution) plots an 3<span 
class="cmmi-10">D </span>hybrid arc with color.
         <ul class="itemize2">
         <li class="itemize">plotHarcColor3D(t,j,x,L) plots the trajectory <span 
class="cmmi-10">x </span>(3 states) taking into account the hybrid time
         domain (<span 
class="cmmi-10">t,j</span>). The hybrid arc is plotted with <span 
class="cmmi-10">L </span>data as color. The input vectors <span 
class="cmmi-10">t,</span><span 
class="cmmi-10">&#x00A0;j,</span><span 
class="cmmi-10">&#x00A0;x,</span><span 
class="cmmi-10">&#x00A0;L </span>must
         have the same length and <span 
class="cmmi-10">x </span>must have three columns.
         </li>
         <li class="itemize">plotHarcColor3D(t,j,x,L,<span 
class="cmmi-10">jstar</span>) If a specific interval in <span 
class="cmmi-10">j </span>is required, <span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>] must
         be provided.
         </li>
         <li class="itemize">plotHarcColor3D(t,j,x,L,<span 
class="cmmi-10">jstar</span>,modificator) Modificator is a cell array that contains the standard
         matlab ploting modificators (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarcColor3D or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotHarcColor3D in
         the command window for more information).</li></ul>
     </li></ul>
                                                                                         
                                                                                         
<!--l. 301--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-120004"></a>HyEQ Simulator: A Simulink implementation for simulation of single and interconnected hybrid systems
with or without inputs</h3>
<!--l. 304--><p class="noindent" >The HyEQ Toolbox includes three main Simulink library blocks that allow for simulation of a hybrid system
<span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>= (<span 
class="cmmi-10">C,f,D,g</span>) using either externally defined functions or embedded MATLAB functions, and a single hybrid
system or interconnected hybrid systems with inputs using embedded MATLAB functions. Figure&#x00A0;<a 
href="#x1-120013">3<!--tex4ht:ref: fig:Simulinklibblocks --></a> shows these
blocks in the Simulink Library Browser.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-120013"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 307--><p class="noindent" >
</p><!--l. 308--><p class="noindent" ><img 
src="HyEQ_Toolbox_v2035x.png" alt="PIC" class="graphics" width="469.75502pt" height="222.30252pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2035x.png" src="figures/Simulink/Simulinkimplementation.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">MATLAB/Simulink library blocks for Simulink implementation.</span></div><!--tex4ht:label?: x1-120013 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-120024"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 317--><p class="noindent" >
</p><!--l. 318--><p class="noindent" ><img 
src="HyEQ_Toolbox_v2036x.png" alt="PIC" class="graphics" width="352.31625pt" height="208.25215pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2036x.png" src="figures/Simulink/HSinput.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">MATLAB/Simulink implementation of a hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /> </span>= (<span 
class="cmmi-10">C,f,D,g</span>) with inputs.</span></div><!--tex4ht:label?: x1-120024 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
<!--l. 324--><p class="indent" >   Figure&#x00A0;<a 
href="#x1-120024">4<!--tex4ht:ref: fig:HSinput --></a> shows a Simulink implementation for simulating a hybrid system with inputs using embedded
MATLAB functions. In this implementation, four basic blocks are used to define the <span 
class="cmti-10">data </span>of the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span>:
</p>
     <ul class="itemize1">
     <li class="itemize">The flow map is implemented in an <span 
class="cmti-10">Embedded MATLAB function block </span>executing the function <span 
class="cmtt-10">f.m</span>. Its
     input is a vector with components defining the state of the system <span 
class="cmmi-10">x</span>, and the input <span 
class="cmmi-10">u</span>. Its output is
     the value of the flow map <span 
class="cmmi-10">f </span>which is connected to the input of an integrator.
     </li>
     <li class="itemize">The flow set is implemented in an <span 
class="cmti-10">Embedded MATLAB function block </span>executing the function <span 
class="cmtt-10">C.m</span>. Its
     input is a vector with components <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> and input <span 
class="cmmi-10">u </span>of the <span 
class="cmti-10">Integrator system</span>. Its output is equal to 1 if
     the state belongs to the set <span 
class="cmmi-10">C </span>or equal to 0 otherwise. The minus notation denotes the previous value
     of the variables (before integration). The value <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> is obtained from the state port of the integrator.
     </li>
     <li class="itemize">The jump map is implemented in an <span 
class="cmti-10">Embedded MATLAB function block </span>executing the function <span 
class="cmtt-10">g.m</span>.
     Its input is a vector with components <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> and input <span 
class="cmmi-10">u </span>of the <span 
class="cmti-10">Integrator system</span>. Its output is the value
     of the jump map <span 
class="cmmi-10">g</span>.
     </li>
     <li class="itemize">The jump set is implemented in an <span 
class="cmti-10">Embedded MATLAB function block </span>executing the function <span 
class="cmtt-10">D.m</span>. Its
     input is a vector with components <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> and input <span 
class="cmmi-10">u </span>of the <span 
class="cmti-10">Integrator system</span>. Its output is equal to 1 if
     the state belongs to <span 
class="cmmi-10">D </span>or equal to 0 otherwise.</li></ul>
<!--l. 339--><p class="indent" >   In our implementation, MATLAB <span 
class="cmtt-10">.m </span>files are used. The file <span 
class="cmtt-10">initialization.m </span>is used to define
initial variables before simulation. The file <span 
class="cmtt-10">postprocessing.m </span>is used to plot the solutions after a
simulation is complete. These two <span 
class="cmtt-10">.m </span>files are called by double-clicking the <span 
class="cmti-10">Double Click to... </span>blocks
at the top of the Simulink Model (see Section <a 
href="#x1-230004.5">4.5<!--tex4ht:ref: sec:postprocessing --></a> for more information on these <span 
class="cmtt-10">.m </span>files and their
use).
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-130004.1"></a>The Integrator System</h4>
<!--l. 344--><p class="noindent" >In this section we discuss the internals of the <span 
class="cmti-10">Integrator System </span>shown in Figure&#x00A0;<a 
href="#x1-130015">5<!--tex4ht:ref: fig:integratorsystem --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-130015"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 347--><p class="noindent" >
</p><!--l. 348--><p class="noindent" ><img 
src="HyEQ_Toolbox_v2037x.png" alt="PIC" class="graphics" width="446.26582pt" height="202.10823pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2037x.png" src="figures/Simulink/Integrator.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5: </span><span  
class="content">Integrator System</span></div><!--tex4ht:label?: x1-130015 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <h5 class="subsubsectionHead"><span class="titlemark">4.1.1   </span> <a 
 id="x1-140004.1.1"></a>CT Dynamics</h5>
<!--l. 357--><p class="noindent" >This block is shown in Figure&#x00A0;<a 
href="#x1-140026">6<!--tex4ht:ref: fig:CTdynamics --></a>. It defines the continuous-time (CT) dynamics by assembling the time derivative of
the state [<span 
class="cmmi-10">t</span><span 
class="cmmi-10">&#x00A0;j</span><span 
class="cmmi-10">&#x00A0;x</span><sup><span 
class="cmsy-7">&#x22A4;</span></sup>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup>. States <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are considered states of the system because they need to be updated throughout
the simulation in order to keep track of the time and number of jumps. Without <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j</span>, solutions could not be
plotted accurately. This is given by </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v2038x.png" alt="t&#x02D9;= 1,   &#x02D9;j = 0,   x&#x02D9;= f(x,u) .
" class="math-display"  /></center>
</div>Note that input port 1 takes the value of <span 
class="cmmi-10">f</span>(<span 
class="cmmi-10">x,u</span>) through the output of the <span 
class="cmti-10">Embedded MATLAB function block f </span>in
Figure&#x00A0;<a 
href="#x1-120024">4<!--tex4ht:ref: fig:HSinput --></a>.
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-140026"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 366--><p class="noindent" >
</p><!--l. 367--><p class="noindent" ><img 
src="HyEQ_Toolbox_v2039x.png" alt="PIC" class="graphics" width="187.89914pt" height="85.12825pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v2039x.png" src="figures/Simulink/CTdynamics.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;6: </span><span  
class="content">CT dynamics</span></div><!--tex4ht:label?: x1-140026 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <h5 class="subsubsectionHead"><span class="titlemark">4.1.2   </span> <a 
 id="x1-150004.1.2"></a>Jump Logic</h5>
<!--l. 376--><p class="noindent" >This block is shown in Figure&#x00A0;<a 
href="#x1-150017">7<!--tex4ht:ref: fig:JumpLogic --></a>. The inputs to the jump logic block are the output of the blocks <span 
class="cmti-10">C </span>and <span 
class="cmti-10">D</span>
indicating whether the state is in those sets or not, and a random signal with uniform distribution
in [0<span 
class="cmmi-10">,</span>1]. Figure&#x00A0;<a 
href="#x1-150017">7<!--tex4ht:ref: fig:JumpLogic --></a> shows the Simulink blocks used to implement the Jump Logic. The variable <span 
class="cmti-10">rule</span>
defines whether the simulator gives priority to jumps, priority to flows, or no priority. It is initialized in
<span 
class="cmtt-10">initialization.m</span>.
</p><!--l. 378--><p class="indent" >   The output of the Jump Logic is equal to one when: </p>
     <ul class="itemize1">
     <li class="itemize">the output of the <span 
class="cmti-10">D block </span>is equal to one and <span 
class="cmmi-10">rule </span>= 1,
     </li>
     <li class="itemize">the output of the <span 
class="cmti-10">C block </span>is equal to zero, the output of the <span 
class="cmti-10">D block </span>is equal to one, and <span 
class="cmmi-10">rule </span>= 2,
     </li>
     <li class="itemize">the output of the <span 
class="cmti-10">C block </span>is equal to zero, the output of the <span 
class="cmti-10">D block </span>is equal to one, and <span 
class="cmmi-10">rule </span>= 3,
     </li>
     <li class="itemize">or the output of the <span 
class="cmti-10">C block </span>is equal to one, the output of the <span 
class="cmti-10">D block </span>is equal to one, <span 
class="cmmi-10">rule </span>= 3, and
     the random signal <span 
class="cmmi-10">r </span>is larger or equal than 0<span 
class="cmmi-10">.</span>5.</li></ul>
<!--l. 385--><p class="noindent" >Under these events, the output of this block, which is connected to the integrator external reset input, triggers a reset
of the integrator, that is, a jump of <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span>. The reset or jump is activated since the configuration of the
reset input is set to &#8220;level hold&#8221;, which executes resets when this external input is equal to one (if the
next input remains set to one, multiple resets would be triggered). Otherwise, the output is equal to
zero.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-150017"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 388--><p class="noindent" >
</p><!--l. 389--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20310x.png" alt="PIC" class="graphics" width="375.80544pt" height="124.8403pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20310x.png" src="figures/Simulink/JumpLogic.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;7: </span><span  
class="content">Jump Logic</span></div><!--tex4ht:label?: x1-150017 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <h5 class="subsubsectionHead"><span class="titlemark">4.1.3   </span> <a 
 id="x1-160004.1.3"></a>Update Logic</h5>
<!--l. 398--><p class="noindent" >This block is shown in Figure&#x00A0;<a 
href="#x1-160028">8<!--tex4ht:ref: fig:UpdateLogic --></a>. The update logic uses the <span 
class="cmti-10">state port </span>information of the integrator. This port
reports the value of the state of the integrator, [<span 
class="cmmi-10">t</span><span 
class="cmmi-10">&#x00A0;j</span><span 
class="cmmi-10">&#x00A0;x</span><sup><span 
class="cmsy-7">&#x22A4;</span></sup>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup>, at the exact instant that the reset condition
becomes true. Notice that <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> differs from <span 
class="cmmi-10">x </span>since at a jump, <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> indicates the value of the state that
triggers the jump, but it is never assigned as the output of the integrator. In other words, &#8220;<span 
class="cmmi-10">x </span><span 
class="cmsy-10">&#x2208; </span><span 
class="cmmi-10">D</span>&#8221;
is checked using <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup> and if true, <span 
class="cmmi-10">x </span>is reset to <span 
class="cmmi-10">g</span>(<span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup><span 
class="cmmi-10">,u</span>). Notice, however, that <span 
class="cmmi-10">u </span>is the same because
at a jump, <span 
class="cmmi-10">u </span>indicates the next evaluated value of the input, and it is assigned as the output of the
integrator. The flow time <span 
class="cmmi-10">t </span>is kept constant at jumps and <span 
class="cmmi-10">j </span>is incremented by one. More precisely
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20311x.png" alt=" +   -      +    -         +     -
t = t ,    j  = j + 1,    x  = g(x  ,u)
" class="math-display"  /></center>
</div>where [<span 
class="cmmi-10">t</span><sup><span 
class="cmsy-7">-</span></sup><span 
class="cmmi-10">&#x00A0;j</span><sup><span 
class="cmsy-7">-</span></sup><span 
class="cmmi-10">&#x00A0;</span><span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup><sup><span 
class="cmsy-7">&#x22A4;</span></sup>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup> is the state that triggers the jump.
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-160028"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 405--><p class="noindent" >
</p><!--l. 406--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20312x.png" alt="PIC" class="graphics" width="187.89914pt" height="90.31194pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20312x.png" src="figures/Simulink/UpdateLogic.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;8: </span><span  
class="content">Update Logic</span></div><!--tex4ht:label?: x1-160028 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <h5 class="subsubsectionHead"><span class="titlemark">4.1.4   </span> <a 
 id="x1-170004.1.4"></a>Stop Logic</h5>
<!--l. 415--><p class="noindent" >This block is shown in Figure&#x00A0;<a 
href="#x1-170019">9<!--tex4ht:ref: fig:StopLogic --></a>. It stops the simulation under any of the following events: </p>
     <ul class="itemize1">
     <li class="itemize">The flow time is larger than or equal to the maximum flow time specified by <span 
class="cmmi-10">T</span>.
     </li>
     <li class="itemize">The jump time is larger than or equal to the maximum number of jumps specified by <span 
class="cmmi-10">J</span>.
     </li>
     <li class="itemize">The state of the hybrid system <span 
class="cmmi-10">x </span>is neither in <span 
class="cmmi-10">C </span>nor in <span 
class="cmmi-10">D</span>.</li></ul>
<!--l. 422--><p class="noindent" >Under any of these events, the output of the logic operator connected to the <span 
class="cmti-10">Stop block </span>becomes one, stopping the
simulation. Note that the inputs <span 
class="cmmi-10">C </span>and <span 
class="cmmi-10">D </span>are routed from the output of the blocks computing whether the state is
in <span 
class="cmmi-10">C </span>or <span 
class="cmmi-10">D </span>and use the value of <span 
class="cmmi-10">x</span><sup><span 
class="cmsy-7">-</span></sup>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                                         
                                                                                         
<a 
 id="x1-170019"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 427--><p class="noindent" >
</p><!--l. 428--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20313x.png" alt="PIC" class="graphics" width="234.8775pt" height="138.89694pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20313x.png" src="figures/Simulink/StopLogic.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;9: </span><span  
class="content">Stop Logic</span></div><!--tex4ht:label?: x1-170019 -->
</div>
                                                                                         
                                                                                         
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-180004.2"></a>Software Requirements</h4>
<!--l. 439--><p class="noindent" >In order to run simulations of single hybrid systems using externally defined functions, MATLAB with Simulink is
required.
</p><!--l. 441--><p class="indent" >   In order to run simulations using the HyEQ Simulator with embedded MATLAB functions, MATLAB/Simulink
and a supported ANSI, C, or C++ 32-bit compiler must be installed. We now briefly describe how to install
necessary compilers for Windows and Mac/Linux. For more information on supported compilers, please visit
<a 
href="http://www.mathworks.com/support/compilers/R2012b/win64.html" class="url" ><span 
class="cmtt-10">http://www.mathworks.com/support/compilers/R2012b/win64.html</span></a>.
</p><!--l. 444--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.2.1   </span> <a 
 id="x1-190004.2.1"></a>Configuration of HyEQ Simulator with embedded functions for Windows</h5>
<!--l. 445--><p class="noindent" >For 32-bit Windows, the LCC compiler is included with MATLAB. First, open MATLAB and then locate and
choose a compiler for building MEX-files by typing
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-3">
&#x00A0;&#x003E;&#x003E;&#x00A0;mex&#x00A0;-setup&#x00A0;
</div>
<!--l. 445--><p class="nopar" >into the MATLAB command window. Then, follow the prompts as shown below.
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-4">
&#x003E;&#x003E;&#x00A0;mex&#x00A0;-setup
&#x00A0;<br />
&#x00A0;<br />Welcome&#x00A0;to&#x00A0;mex&#x00A0;-setup.&#x00A0;&#x00A0;This&#x00A0;utility&#x00A0;will&#x00A0;help&#x00A0;you&#x00A0;set&#x00A0;up
&#x00A0;<br />a&#x00A0;default&#x00A0;compiler.&#x00A0;&#x00A0;For&#x00A0;a&#x00A0;list&#x00A0;of&#x00A0;supported&#x00A0;compilers,&#x00A0;see
&#x00A0;<br />http://www.mathworks.com/support/compilers/R2012a/win32.html
&#x00A0;<br />
&#x00A0;<br />Please&#x00A0;choose&#x00A0;your&#x00A0;compiler&#x00A0;for&#x00A0;building&#x00A0;MEX-files:
&#x00A0;<br />
&#x00A0;<br />Would&#x00A0;you&#x00A0;like&#x00A0;mex&#x00A0;to&#x00A0;locate&#x00A0;installed&#x00A0;compilers&#x00A0;[y]/n?&#x00A0;y
&#x00A0;<br />
&#x00A0;<br />Select&#x00A0;a&#x00A0;compiler:
&#x00A0;<br />[1]&#x00A0;Lcc-win32&#x00A0;C&#x00A0;2.4.1
&#x00A0;<br />
&#x00A0;<br />[0]&#x00A0;None
&#x00A0;<br />
&#x00A0;<br />Compiler:&#x00A0;1
&#x00A0;<br />
&#x00A0;<br />Please&#x00A0;verify&#x00A0;your&#x00A0;choices:
&#x00A0;<br />
&#x00A0;<br />Compiler:&#x00A0;Lcc-win32&#x00A0;C&#x00A0;2.4.1
&#x00A0;<br />
&#x00A0;<br />Are&#x00A0;these&#x00A0;correct&#x00A0;[y]/n?&#x00A0;y
&#x00A0;<br />
&#x00A0;<br />Done&#x00A0;.&#x00A0;.&#x00A0;.
</div>
<!--l. 473--><p class="nopar" >
</p><!--l. 475--><p class="indent" >   For 64-bit Windows, a C-compiler is not supplied with MATLAB. Before running the HyEQ Toolbox in
MATLAB/Simulink, please follow the following steps:
</p><!--l. 477--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-19002x1">If  you  don&#8217;t  have  <span 
class="cmti-10">Microsoft .NET Framework 4 </span>on  your  computer,  download  and  install  it  from
     <a 
href="http://www.microsoft.com/en-us/download/details.aspx?id=17851" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?id=17851</span></a>.
     </li>
     <li 
  class="enumerate" id="x1-19004x2">Then         download         and         install         <span 
class="cmti-10">Microsoft        Windows        SDK         </span>from
     <a 
href="http://www.microsoft.com/en-us/download/details.aspx?id=8279" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?id=8279</span></a>.
     </li>
     <li 
  class="enumerate" id="x1-19006x3">Then perform the steps outlined above for 32-bit Windows to setup and install the compiler.</li></ol>
<!--l. 485--><p class="indent" >   As of October 10, 2013, when installing the toolbox in Windows 8, please follow the next steps.
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-19008x1">If  you  don&#8217;t  have  <span 
class="cmti-10">Microsoft .NET Framework 4 </span>on  your  computer,  download  and  install  it  from
     <a 
href="http://www.microsoft.com/en-us/download/details.aspx?id=8279" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?id=8279</span></a>.
     </li>
     <li 
  class="enumerate" id="x1-19010x2">Then download and install <span 
class="cmti-10">Microsoft Windows SDK</span>
         <ul class="itemize1">
         <li class="itemize">If you don&#8217;t have <span 
class="cmti-10">Visual C++ 2010 SP1 </span>installed on your computer:
                                                                                         
                                                                                         
             <ul class="itemize2">
             <li class="itemize">Download        and        install        <span 
class="cmti-10">Microsoft       Windows       SDK       7.1       </span>from
             <a 
href="http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=4422" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=4422</span></a>
             </li>
             <li class="itemize">Apply    the    following    patch    from    <span 
class="cmti-10">Microsoft   </span>onto    the    <span 
class="cmti-10">SDK   7.1   </span>installation:
             <a 
href="http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=4422" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=4422</span></a></li></ul>
         </li>
         <li class="itemize">If you have Visual <span 
class="cmti-10">Visual C++ 2010 SP1 </span>or its redistributable packages installed on your
         computer:
             <ul class="itemize2">
             <li class="itemize">Uninstall the <span 
class="cmti-10">Visual C++ 2010 </span>redistributable packages, both x64 and x86 versions. This can
             be done from <span 
class="cmti-10">Control Panel </span><span 
class="cmmi-10">&#x2215; </span><span 
class="cmti-10">Uninstall Programs Menu</span>.
             </li>
             <li class="itemize">Download        and        install        <span 
class="cmti-10">Microsoft       Windows       SDK       7.1       </span>from
             <a 
href="http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=4422" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=4422</span></a>
             </li>
             <li class="itemize">Apply    the    following    patch    from    <span 
class="cmti-10">Microsoft   </span>onto    the    <span 
class="cmti-10">SDK   7.1   </span>installation:
             <a 
href="http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=4422" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=4422</span></a>
             </li>
             <li class="itemize">Reinstall the <span 
class="cmti-10">Visual C++ 2010 </span>redistributable packages:
             <!--l. 505--><p class="noindent" >x86 version: <a 
href="http://www.microsoft.com/en-us/download/details.aspx?id=5555" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?id=5555</span></a>
             </p><!--l. 508--><p class="noindent" >x64 version: <a 
href="http://www.microsoft.com/en-us/download/details.aspx?id=14632" class="url" ><span 
class="cmtt-10">http://www.microsoft.com/en-us/download/details.aspx?id=14632</span></a></p></li></ul>
         </li></ul>
     </li>
     <li 
  class="enumerate" id="x1-19012x3">Then perform the steps outlined above for 32-bit Windows to setup and install the compiler.</li></ol>
<!--l. 515--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">4.2.2   </span> <a 
 id="x1-200004.2.2"></a>Configuration of HyEQ Simulator with embedded functions for Mac/Linux</h5>
<!--l. 517--><p class="noindent" >From a terminal window, check that the file <span 
class="cmtt-10">gcc </span>is in the folder <span 
class="cmtt-10">/usr/bin</span>. If it is not there, make a symbolic link. You
might require to install the latest version of <span 
class="cmtt-10">Xcode </span>first. In order to generate a symbolic link for gcc, that MATLAB can
find to compile the simulation files (see <a 
href="http://www.mathworks.com/support/sysreq/previous_releases.html" class="url" ><span 
class="cmtt-10">http://www.mathworks.com/support/sysreq/previous_releases.html</span></a>),
change folder to <span 
class="cmtt-10">/usr/bin </span>and then
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-5">
sudo&#x00A0;ln&#x00A0;-s&#x00A0;gcc&#x00A0;gcc-4.2
</div>
<!--l. 524--><p class="nopar" >Then, it should be possible to setup the gcc compiler in matlab as follows:
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-6">
&#x003E;&#x003E;&#x00A0;mex&#x00A0;-setup
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Options&#x00A0;files&#x00A0;control&#x00A0;which&#x00A0;compiler&#x00A0;to&#x00A0;use,&#x00A0;the&#x00A0;compiler&#x00A0;and&#x00A0;link&#x00A0;command
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;options,&#x00A0;and&#x00A0;the&#x00A0;runtime&#x00A0;libraries&#x00A0;to&#x00A0;link&#x00A0;against.
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Using&#x00A0;the&#x00A0;&#8217;mexsh&#x00A0;-setup&#8217;&#x00A0;command&#x00A0;selects&#x00A0;an&#x00A0;options&#x00A0;file&#x00A0;that&#x00A0;is
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;placed&#x00A0;in&#x00A0;~/.matlab/R2013b&#x00A0;and&#x00A0;used&#x00A0;by&#x00A0;default&#x00A0;for&#x00A0;&#8217;mexsh&#8217;.&#x00A0;An&#x00A0;options
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;file&#x00A0;in&#x00A0;the&#x00A0;current&#x00A0;working&#x00A0;directory&#x00A0;or&#x00A0;specified&#x00A0;on&#x00A0;the&#x00A0;command&#x00A0;line
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;overrides&#x00A0;the&#x00A0;default&#x00A0;options&#x00A0;file&#x00A0;in&#x00A0;~/.matlab/R2013b.
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;To&#x00A0;override&#x00A0;the&#x00A0;default&#x00A0;options&#x00A0;file,&#x00A0;use&#x00A0;the&#x00A0;&#8217;mexsh&#x00A0;-f&#8217;&#x00A0;command
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;(see&#x00A0;&#8217;mexsh&#x00A0;-help&#8217;&#x00A0;for&#x00A0;more&#x00A0;information).
&#x00A0;<br />
</div>
<!--l. 540--><p class="nopar" >
</p><!--l. 542--><p class="indent" >   The options files available for MEX are:
                                                                                         
                                                                                         
</p>
   <div class="verbatim" id="verbatim-7">
The&#x00A0;options&#x00A0;files&#x00A0;available&#x00A0;for&#x00A0;mexsh&#x00A0;are:
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;1:&#x00A0;/Applications/MATLAB_R2013b.app/bin/mexopts.sh&#x00A0;:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Template&#x00A0;Options&#x00A0;file&#x00A0;for&#x00A0;building&#x00A0;MEX-files
&#x00A0;<br />
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;0:&#x00A0;Exit&#x00A0;with&#x00A0;no&#x00A0;changes
&#x00A0;<br />
&#x00A0;<br />Enter&#x00A0;the&#x00A0;number&#x00A0;of&#x00A0;the&#x00A0;compiler&#x00A0;(0-1):&#x00A0;1
&#x00A0;<br />
&#x00A0;<br />Overwrite&#x00A0;~/.matlab/R2013b/mexopts.sh&#x00A0;([y]/n)?:&#x00A0;Y
&#x00A0;<br />
&#x00A0;<br />/Applications/MATLAB_R2013b.app/bin/mexopts.sh&#x00A0;is&#x00A0;being&#x00A0;copied&#x00A0;to
&#x00A0;<br />/SOME_FOLDER/mexopts.sh
&#x00A0;<br />
</div>
<!--l. 560--><p class="nopar" >
</p><!--l. 562--><p class="indent" >   At this point, it is possible to check if the <span 
class="cmmi-10">gcc </span>is properly setup by testing any of the Simulink examples with
embedded functions (see Figure&#x00A0;<a 
href="#x1-120013">3<!--tex4ht:ref: fig:Simulinklibblocks --></a>) (e.g., Examples&#x00A0;<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a>,&#x00A0;<a 
href="#x1-240074">1.4<!--tex4ht:ref: ex:bbblocks --></a>,&#x00A0;<a 
href="#x1-240095">1.5<!--tex4ht:ref: ex:dubinspath --></a>,&#x00A0;<a 
href="#x1-240146">1.6<!--tex4ht:ref: ex:interconnection1 --></a>,&#x00A0;<a 
href="#x1-240267">1.7<!--tex4ht:ref: ex:fireflies --></a> or&#x00A0;<a 
href="#x1-240338">1.8<!--tex4ht:ref: ex:overlap1 --></a>).
</p><!--l. 564--><p class="indent" >   If an error regarding &#8220;<span 
class="cmmi-10">gmake</span>&#8221; similar to &#8220;No supported compiler or SDK was found&#8221; and/or a warning &#8220;no such
sysrooot directory: <span 
class="cmsy-10">&#x2032;</span>Developer/SDKs/MacOSX10.X.sdk<span 
class="cmsy-10">&#x2032;</span>&#8221; is shown when compiling, please consider the following
procedure.
</p>
     <ul class="itemize1">
     <li class="itemize">For Matlab 2013b and previous:
     <!--l. 569--><p class="noindent" >The  compiler  can  not  find  the  appropriate  path.  It  is  necesary  to  change  some  lines  in  the  file
     &#8220;<span 
class="cmmi-10">mexopts.sh</span>&#8221; (copied previously in the folder &#8220;SOME_FOLDER&#8221;) .
     </p><!--l. 571--><p class="noindent" >First, locate the Xcode-SDK in your hard drive. Open a terminal window and execute the following
     command
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-8">
     xcodebuild&#x00A0;-version&#x00A0;-sdk&#x00A0;macosx10.9&#x00A0;Path
</div>
     <!--l. 574--><p class="nopar" >which returns the location of MacOSX10.9.sdk, denoted here as SDK_FOLDER. Now, in the MATLAB
     command window locate the file &#8220;<span 
class="cmmi-10">mexopts.sh</span>&#8221; by typing
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-9">
     cd&#x00A0;/SOME_FOLDER/
</div>
     <!--l. 578--><p class="nopar" >Then, open the file
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-10">
     edit&#x00A0;mexopts.sh
</div>
     <!--l. 582--><p class="nopar" >and edit the lines </p>
         <ul class="itemize2">
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-11">
         SDKROOT=&#8217;/Developer/SDKs/MacOSX10.X.sdk&#8217;
</div>
         <!--l. 588--><p class="nopar" >to
                                                                                         
                                                                                         
</p>
         <div class="verbatim" id="verbatim-12">
         SDKROOT=&#8217;SDK_FOLDER&#8217;
</div>
         <!--l. 592--><p class="nopar" >and
         </p></li>
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-13">
         MACOSX_DEPLOYMENT_TARGET=&#8217;10.X&#8217;
</div>
         <!--l. 597--><p class="nopar" >to
                                                                                         
                                                                                         
</p>
         <div class="verbatim" id="verbatim-14">
         MACOSX_DEPLOYMENT_TARGET=&#8217;10.9&#8217;
</div>
         <!--l. 601--><p class="nopar" ></p></li></ul>
     <!--l. 604--><p class="noindent" >Now, it is possible to test if the compiler works. If the following error appears &#8220;<span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">unknown</span><span 
class="cmtt-10">&#x00A0;type</span><span 
class="cmtt-10">&#x00A0;name</span><span 
class="cmtt-10">&#x00A0;&#8217;char16_t&#8217;</span></span></span>,&#8221;
     some flags must be changed to avoid this problem. It is required to add <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">-Dchar16_t=UINT16_T</span></span></span> and
     <span class="obeylines-h"><span class="verb"><span 
class="cmtt-10">-std=c++11</span></span></span> to the flags CFLAGS and CFLAGS respectively, e.g., change </p>
         <ul class="itemize2">
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-15">
         CFLAGS="-fno-common&#x00A0;-no-cpp-precomp&#x00A0;-arch&#x00A0;$ARCHS&#x00A0;-isysroot&#x00A0;$SDKROOT
         &#x00A0;<br />-mmacosx-version-min=$MACOSX_DEPLOYMENT_TARGET"
</div>
         <!--l. 612--><p class="nopar" >to
                                                                                         
                                                                                         
</p>
         <div class="verbatim" id="verbatim-16">
         CFLAGS="-fno-common&#x00A0;-no-cpp-precomp&#x00A0;-arch&#x00A0;$ARCHS&#x00A0;-isysroot&#x00A0;$SDKROOT
         &#x00A0;<br />-mmacosx-version-min=$MACOSX_DEPLOYMENT_TARGET&#x00A0;-Dchar16_t=UINT16_T"
</div>
         <!--l. 617--><p class="nopar" >and
         </p></li>
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-17">
         CXXFLAGS="-fno-common&#x00A0;-no-cpp-precomp&#x00A0;-fexceptions&#x00A0;-arch&#x00A0;$ARCHS&#x00A0;-isysroot&#x00A0;$SDKROOT
         &#x00A0;<br />-mmacosx-version-min=$MACOSX_DEPLOYMENT_TARGET"
</div>
         <!--l. 623--><p class="nopar" >to
                                                                                         
                                                                                         
</p>
         <div class="verbatim" id="verbatim-18">
         CXXFLAGS="-fno-common&#x00A0;-no-cpp-precomp&#x00A0;-fexceptions&#x00A0;-arch&#x00A0;$ARCHS&#x00A0;-isysroot&#x00A0;$SDKROOT
         &#x00A0;<br />-mmacosx-version-min=$MACOSX_DEPLOYMENT_TARGET&#x00A0;-std=c++11"
</div>
         <!--l. 628--><p class="nopar" ></p></li></ul>
     <!--l. 630--><p class="noindent" >Finally, restart matlab and test any of the aforementioned Simulink examples. for more information visit
     <a 
href="http://www.mathworks.com/matlabcentral/answers/121315-how-to-set-the-c-compiler-of-matlab2013a-in-osx-10-9" class="url" ><span 
class="cmtt-8">http://www.mathworks.com/matlabcentral/answers/121315-how-to-set-the-c-compiler-of-matlab2013a-in-osx-10-9</span></a>
     </p></li>
     <li class="itemize">For Matlab 2014b and newer.
     <!--l. 636--><p class="noindent" >First, locate the Xcode-SDK in your hard drive. It may be SDK 10.9, 10.10, 10.11, here we are going to denote
     it as <span 
class="cmbx-10">10.X</span>. Open a terminal window and execute the following command
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-19">
     xcodebuild&#x00A0;-version&#x00A0;-sdk&#x00A0;macosx10.X&#x00A0;Path
</div>
     <!--l. 639--><p class="nopar" >which returns the location of MacOSX10.X.sdk. We are interested in the last portion of the path, specifically
     after /Applications/Xcode.app/.Contents/Developer/, denoted here as <span 
class="cmbx-10">SDK</span><span 
class="cmbx-10">_FOLDER</span>. Now, locate and
     edit the following files
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-20">
     /Applications/MATLAB_R201??.app/bin/maci64/mexopts/clang_maci64.xml
</div>
     <!--l. 642--><p class="nopar" >
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-21">
     /Applications/MATLAB_R201??.app/bin/maci64/mexopts/clang++_maci64.xml
</div>
     <!--l. 643--><p class="nopar" >Inside those files there are the lines
                                                                                         
                                                                                         
</p>
     <div class="verbatim" id="verbatim-22">
     &#x003C;dirExists&#x00A0;name="$$/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.10.sdk"&#x00A0;/&#x003E;
     &#x00A0;<br />&#x003C;cmdReturns&#x00A0;name="find&#x00A0;$$&#x00A0;-name&#x00A0;MacOSX10.10.sdk"&#x00A0;/&#x003E;
</div>
     <!--l. 648--><p class="nopar" >
     </p><!--l. 650--><p class="noindent" >edit (or add below those lines) the lines </p>
         <ul class="itemize2">
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-23">
         &#x003C;dirExists&#x00A0;name="$$SDK\_FOLDER"&#x00A0;/&#x003E;
</div>
         <!--l. 655--><p class="nopar" >and
         </p></li>
         <li class="itemize">
                                                                                         
                                                                                         
         <div class="verbatim" id="verbatim-24">
         &#x003C;cmdReturns&#x00A0;name="find&#x00A0;$$&#x00A0;-name&#x00A0;MacOSX10.X.sdk"&#x00A0;/&#x003E;
</div>
         <!--l. 660--><p class="nopar" ></p></li></ul>
     <!--l. 663--><p class="noindent" >Finally, restart matlab and test any of the aforementioned Simulink examples. for more information visit
     <a 
href="https://bitbucket.org/d2d-development/d2d-software/issues/46/xcode-7-on-osx-with-matlab-r2015a-b" class="url" ><span 
class="cmtt-8">https://bitbucket.org/d2d-development/d2d-software/issues/46/xcode-7-on-osx-with-matlab-r2015a-b</span></a>
</p>
     </li></ul>
<!--l. 669--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-210004.3"></a>Configuration of Integration Scheme</h4>
<!--l. 670--><p class="noindent" >Before a simulation is started, it is important to determine the needed integrator scheme, zero-cross detection
settings, precision, and other tolerances. Using the default settings does not always give the most efficient
or most accurate simulations. One way to edit these settings is to open the Simulink Model, select
<span 
class="cmtt-10">Simulation&#x003E;Configuration Parameters&#x003E;Solver</span>, and change the settings there. We have made this simple by
defining variables for configuration parameters in the <span 
class="cmtt-10">initialization.m </span>file. The last few lines of the
<span 
class="cmtt-10">initialization.m </span>file look like that given below.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%configuration</span><span 
class="pcrr7t-">&#x00A0;of</span><span 
class="pcrr7t-">&#x00A0;solver</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;RelTol</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1e-8;</span></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;MaxStep</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;.001;</span></span><br 
class="newline" />
</p><!--l. 675--><p class="indent" >   In these lines, &#8220;RelTol = 1e-8&#8221; and &#8220;MaxStep = .001&#8221; define the relative tolerance and maximum
step size of the ODE solver, respectively. These parameters greatly affect the speed and accuracy of
solutions.
</p><!--l. 677--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-220004.4"></a>Initialization</h4>
<!--l. 679--><p class="noindent" >When the block labeled <span 
class="cmti-10">Double Click to Initialize </span>at the top of the Simulink Model is double-clicked, the simulation
variables are initialized by calling the script <span 
class="cmtt-10">initialization.m</span>. The script <span 
class="cmtt-10">initialization.m </span>defines the initial
conditions by defining the initial values of the state components, any necessary parameters, the maximum flow time
specified by <span 
class="cmmi-10">T</span>, the maximum number of jumps specified by <span 
class="cmmi-10">J</span>, and tolerances used when simulating. These can be
changed by editing the script file <span 
class="cmtt-10">initialization.m</span>. See below for sample code to initialize the bouncing ball
example, Example &#x00A0;<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a>.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;initialization</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;bouncing</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;example</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clear</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">all</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;initial</span><span 
class="pcrr7t-">&#x00A0;conditions</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x0</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[1;0];</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;simulation</span><span 
class="pcrr7t-">&#x00A0;horizon</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;T</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;10;</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;J</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;20;</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;jumps</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;priority</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;flows</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;3</span><span 
class="pcrr7t-">&#x00A0;-&#x003E;</span><span 
class="pcrr7t-">&#x00A0;no</span><span 
class="pcrr7t-">&#x00A0;priority,</span><span 
class="pcrr7t-">&#x00A0;random</span><span 
class="pcrr7t-">&#x00A0;selection</span><span 
class="pcrr7t-">&#x00A0;when</span><span 
class="pcrr7t-">&#x00A0;simultaneous</span><span 
class="pcrr7t-">&#x00A0;conditions</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;rule</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%configuration</span><span 
class="pcrr7t-">&#x00A0;of</span><span 
class="pcrr7t-">&#x00A0;solver</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;RelTol</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1e-8;</span></span><br 
class="newline" />
</p><!--l. 684--><p class="indent" >   It is important to note that variables called in the <span 
class="cmti-10">Embedded MATLAB function blocks </span>must be added as inputs
and labeled as &#8220;parameters&#8221;. This can be done by opening the <span 
class="cmti-10">Embedded MATLAB function block </span>selecting
<span 
class="cmtt-10">Tools&#x003E;Edit Data/Ports </span>and setting the scope to <span 
class="cmtt-10">Parameter</span>.
</p><!--l. 689--><p class="indent" >   After the block labeled <span 
class="cmti-10">Double Click to Initialize </span>is double-clicked and the variables initialized, the simulation is
run by clicking the run button or selecting <span 
class="cmtt-10">Simulation&#x003E;Start</span>.
</p><!--l. 692--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-230004.5"></a>Postprocessing and Plotting solutions</h4>
<!--l. 695--><p class="noindent" >A similar procedure is used to define the plots of solutions after the simulation is run. The solutions can be plotted
by double-clicking on the block at the top of the Simulink Model labeled <span 
class="cmti-10">Double Click to Plot Solutions </span>which calls
the script <span 
class="cmtt-10">postprocessing.m</span>. The script <span 
class="cmtt-10">postprocessing.m </span>may be edited to include the desired
postprocessing and solution plots. See below for sample code to plot solutions to the bouncing ball example,
Example&#x00A0;<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a>.<br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%postprocessing</span><span 
class="pcrr7t-">&#x00A0;for</span><span 
class="pcrr7t-">&#x00A0;the</span><span 
class="pcrr7t-">&#x00A0;bouncing</span><span 
class="pcrr7t-">&#x00A0;ball</span><span 
class="pcrr7t-">&#x00A0;example</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;solution</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(1)</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;clf</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,1),plotflows(t,j,x)</span></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;subplot(2,1,2),plotjumps(t,j,x)</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;plot</span><span 
class="pcrr7t-">&#x00A0;hybrid</span><span 
class="pcrr7t-">&#x00A0;arc</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;figure(2)</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;plotHybridArc(t,j,x)</span></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'j'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;ylabel(</span></span><span class="verb"><span 
class="pcrr7t-">'t'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;zlabel(</span></span><span class="verb"><span 
class="pcrr7t-">'x'</span></span><span class="verb"><span 
class="pcrr7t-">)</span></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;grid</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">on</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;view(37.5,30)</span></span><br 
class="newline" />
</p><!--l. 699--><p class="noindent" >The following functions are used to generate the plots: </p>
     <ul class="itemize1">
     <li class="itemize">plotflows(t,j,x): plots (in blue) the projection of the trajectory <span 
class="cmmi-10">x </span>onto the flow time axis <span 
class="cmmi-10">t</span>. The value
     of the trajectory for intervals [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] with empty interior is marked with <span 
class="cmsy-10">* </span>(in blue). Dashed lines (in
     red) connect the value of the trajectory before and after the jump. Figure&#x00A0;<a 
href="#x1-24003r1">10(a)<!--tex4ht:ref: fig:input-1 --></a> shows a plot created
     with this function.
     </li>
     <li class="itemize">plotjumps(t,j,x): plots (in red) the projection of the trajectory <span 
class="cmmi-10">x </span>onto the jump time <span 
class="cmmi-10">j</span>. The initial
     and final value of the trajectory on each interval [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] is denoted by <span 
class="cmsy-10">* </span>(in red) and the continuous
     evolution of the trajectory on each interval is depicted with a dashed line (in blue). Figure&#x00A0;<a 
href="#x1-24003r1">10(a)<!--tex4ht:ref: fig:input-1 --></a> shows
     a plot created with this function.
     </li>
     <li class="itemize">plotHybridArc(t,j,x): plots (in blue and red) the trajectory <span 
class="cmmi-10">x </span>on hybrid time domains. The intervals
                                                                                         
                                                                                         
     [<span 
class="cmmi-10">t</span><sub><span 
class="cmmi-7">j</span></sub><span 
class="cmmi-10">,t</span><sub><span 
class="cmmi-7">j</span><span 
class="cmr-7">+1</span></sub>] indexed by the corresponding <span 
class="cmmi-10">j </span>are depicted in the <span 
class="cmmi-10">t </span><span 
class="cmsy-10">- </span><span 
class="cmmi-10">j </span>plane (in red). Figure&#x00A0;<a 
href="#x1-2400611">11<!--tex4ht:ref: fig:input-3 --></a> shows a
     plot created with this function.
     </li>
     <li class="itemize">plotHarc is a function for plotting hybrid arcs (n states).
         <ul class="itemize2">
         <li class="itemize">plotHarc(t,j,x): plots the trajectory <span 
class="cmmi-10">x </span>versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>). If <span 
class="cmmi-10">x </span>is a matrix, then
         the time vector is plotted versus the rows or columns of the matrix, whichever line up.
         </li>
         <li class="itemize">plotHarc(t,j,x,<span 
class="cmmi-10">jstar</span>): plots the trajectory <span 
class="cmmi-10">x </span>versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>), and the plot is
         cut regarding the <span 
class="cmmi-10">jstar </span>interval (<span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>]).
         </li>
         <li class="itemize">plotHarc(t,j,x,<span 
class="cmmi-10">jstar</span>,modificator): Modificator is a cell array that contains the standard matlab
         ploting modificators (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarc or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotHarc in the command window
         for more information).</li></ul>
     </li>
     <li class="itemize">plotHarcColor plots the trajectory <span 
class="cmmi-10">x </span>(vector) on hybrid time domain with color.
         <ul class="itemize2">
         <li class="itemize">plotHarcColor(t,j,x,L): plots the trajectory <span 
class="cmmi-10">x </span>(vector) versus the hybrid time domain (<span 
class="cmmi-10">t,j</span>). The
         hybrid arc is plotted with <span 
class="cmmi-10">L </span>data as color. The input vectors <span 
class="cmmi-10">t,</span><span 
class="cmmi-10">&#x00A0;j,</span><span 
class="cmmi-10">&#x00A0;x,</span><span 
class="cmmi-10">&#x00A0;L </span>must have the same
         length.
         </li>
         <li class="itemize">plotHarcColor(t,j,x,L,<span 
class="cmmi-10">jstar</span>): If a specific interval in <span 
class="cmmi-10">j </span>is required, <span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>] must be
         provided. (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarcColor or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotHarcColor in the command window
         for more information)</li></ul>
     </li>
     <li class="itemize">plotHarcColor3D plots an 3<span 
class="cmmi-10">D </span>hybrid arc with color.
         <ul class="itemize2">
         <li class="itemize">plotHarcColor3D(t,j,x,L) plots the trajectory <span 
class="cmmi-10">x </span>(3 states) taking into account the hybrid time
         domain (<span 
class="cmmi-10">t,j</span>). The hybrid arc is plotted with <span 
class="cmmi-10">L </span>data as color. The input vectors <span 
class="cmmi-10">t,</span><span 
class="cmmi-10">&#x00A0;j,</span><span 
class="cmmi-10">&#x00A0;x,</span><span 
class="cmmi-10">&#x00A0;L </span>must
         have the same length and <span 
class="cmmi-10">x </span>must have three columns.
         </li>
         <li class="itemize">plotHarcColor3D(t,j,x,L,<span 
class="cmmi-10">jstar</span>) If a specific interval in <span 
class="cmmi-10">j </span>is required, <span 
class="cmmi-10">jstar </span>= [<span 
class="cmmi-10">j</span><sub><span 
class="cmmi-7">initial</span></sub><span 
class="cmmi-10">,j</span><sub><span 
class="cmmi-7">final</span></sub>] must
         be provided.
         </li>
         <li class="itemize">plotHarcColor3D(t,j,x,L,<span 
class="cmmi-10">jstar</span>,modificator) Modificator is a cell array that contains the standard
         matlab ploting modificators (type <span 
class="cmmi-10">&#x003E;&#x003E; </span>help plotHarcColor3D or <span 
class="cmmi-10">&#x003E;&#x003E; </span>helpwin plotHarcColor3D in
         the command window for more information).</li></ul>
     </li></ul>
<!--l. 740--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-240005"></a>Examples</h3>
<!--l. 1--><p class="noindent" >The examples below illustrate the use of the Simulink implementation above.
</p>
   <div class="newtheorem">
<!--l. 3--><p class="noindent" ><span class="head">
                                                                                         
                                                                                         
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.3</span> </span>(bouncing ball with input) <a 
 id="x1-240013"></a>For the simulation of the bouncing ball system with a constant
input and regular data given by
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20314x.png" alt="                  [ x   ]     {                     }
         f (x,u) :=   - 2&#x03B3;  ,C :=  (x,u) &#x2208; &#x211D;2 &#x00D7; &#x211D; | x1 &#x2265; u                 (4)
        [       ]
g(x,u) :=     u     ,D  := {(x,u) &#x2208; &#x211D;2 &#x00D7; &#x211D; | x1 &#x2264; u , x2 &#x2264; 0}              (5)
          - &#x03BB;x2
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">&#x03B3; &#x003E; </span>0 is the gravity constant, <span 
class="cmmi-10">u </span>is the input constant, and <span 
class="cmmi-10">&#x03BB; </span><span 
class="cmsy-10">&#x2208; </span>[0<span 
class="cmmi-10">,</span>1) is the restitution coefficient. The
MATLAB scripts in each of the function blocks of the implementation above are given as follows. An input was
chosen to be <span 
class="cmmi-10">u</span>(<span 
class="cmmi-10">t,j</span>) = 0<span 
class="cmmi-10">.</span>2 for all (<span 
class="cmmi-10">t,j</span>). The constants for the bouncing ball system are <span 
class="cmmi-10">&#x03B3; </span>= 9<span 
class="cmmi-10">.</span>81 and
<span 
class="cmmi-10">&#x03BB; </span>= 0<span 
class="cmmi-10">.</span>8.
<!--l. 30--><p class="noindent" >The following procedure is used to simulate this example with <span 
class="cmtt-10">HyEQsimulator.mdl</span>: </p>
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10">HyEQsimulator.mdl </span>is opened in MATLAB/Simulink.
     </li>
     <li class="itemize">The <span 
class="cmti-10">Embedded MATLAB function blocks f, C, g, D </span>are edited by double-clicking on the block and
     editing the script. In each embedded function block, parameters must be added as inputs and defined
     as parameters by selecting <span 
class="cmtt-10">Tools&#x003E;Edit Data/Ports</span>, and setting the scope to <span 
class="cmtt-10">Parameter</span>. For this
     example, <span 
class="cmti-10">gamma </span>and <span 
class="cmti-10">lambda </span>are defined in this way.
     </li>
     <li class="itemize">The initialization script <span 
class="cmtt-10">initialization.m </span>is edited by opening the file and editing the script. The
     flow time and jump horizons, <span 
class="cmmi-10">T </span>and <span 
class="cmmi-10">J </span>are defined as well as the initial conditions for the state vector,
     <span 
class="cmmi-10">x</span><sub><span 
class="cmr-7">0</span></sub>, and input vector, <span 
class="cmmi-10">u</span><sub><span 
class="cmr-7">0</span></sub>, and a rule for jumps, <span 
class="cmmi-10">rule</span>.
     </li>
     <li class="itemize">The postprocessing script <span 
class="cmtt-10">postprocessing.m </span>is edited by opening the file and editing the script. Flows
     and jumps may be plotted by calling the functions <span 
class="cmti-10">plotflows </span>and <span 
class="cmti-10">plotjumps</span>, respectively. The hybrid
     arc may be plotted by calling the function <span 
class="cmti-10">plotHybridArc</span>.
     </li>
     <li class="itemize">The  simulation  stop  time  and  other  simulation  parameters  are  set  to  the  values  defined  in
     <span 
class="cmtt-10">initialization.m </span>by selecting <span 
class="cmtt-10">Simulation&#x003E;Configuration Parameters&#x003E;Solver </span>and inputting <span 
class="cmmi-10">T</span>,
     <span 
class="cmmi-10">RelTol</span>, <span 
class="cmmi-10">MaxStep</span>, etc..
     </li>
     <li class="itemize">The masked integrator system is double-clicked and the simulation horizons and initial conditions are
     set as desired.
     </li>
     <li class="itemize">The block labeled <span 
class="cmti-10">Double Click to Initialize </span>is double-clicked to initialize variables.
                                                                                         
                                                                                         
     </li>
     <li class="itemize">The simulation is run by clicking the run button or selecting <span 
class="cmtt-10">Simulation&#x003E;Start</span>.
     </li>
     <li class="itemize">The block labeled <span 
class="cmti-10">Double Click to Plot Solutions </span>is double-clicked to plot the desired solutions.</li></ul>
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2400510"></a> <a 
 id="x1-24003r1"></a> <img 
src="HyEQ_Toolbox_v20315x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20315x.png" src="figures/Examples/FlowsAndJumps1.eps"  
-->
                                       <span 
class="cmr-8">(a) Height</span>
<a 
 id="x1-24004r2"></a> <img 
src="HyEQ_Toolbox_v20316x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20316x.png" src="figures/Examples/FlowsAndJumps2.eps"  
-->
                   <span 
class="cmr-8">(b) Velocity</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;10: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a></span></div><!--tex4ht:label?: x1-2400510 -->
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2400611"></a>
<div class="center" 
>
<!--l. 82--><p class="noindent" >
                                                                                         
                                                                                         
</p><!--l. 86--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20317x.png" alt="PIC" class="graphics" width="375.80544pt" height="282.53006pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20317x.png" src="figures/Examples/HybridArc1.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11: </span><span  
class="content">Hybrid arc corresponding to a solution of Example&#x00A0;<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a>: height</span></div><!--tex4ht:label?: x1-2400611 -->
</div>
   </div><hr class="endfigure" />
<!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x,</span><span 
class="pcrr7t-">&#x00A0;u,</span><span 
class="pcrr7t-">&#x00A0;gamma)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;x2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map:</span><span 
class="pcrr7t-">&#x00A0;xdot=f(x,u);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[x(2);</span><span 
class="pcrr7t-">&#x00A0;gamma];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(x(1)</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;u(1))</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x,</span><span 
class="pcrr7t-">&#x00A0;u,</span><span 
class="pcrr7t-">&#x00A0;lambda)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[u(1);</span><span 
class="pcrr7t-">&#x00A0;-lambda&#x22C6;x(2)];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(x(1)</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;u(1))</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(x(2)</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;0)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
                                                                                         
                                                                                         
</p><!--l. 108--><p class="indent" >   A solution to the bouncing ball system from <span 
class="cmmi-10">x</span>(0<span 
class="cmmi-10">,</span>0) = [1<span 
class="cmmi-10">,</span>0]<sup><span 
class="cmsy-7">&#x22A4;</span></sup> and with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 1, is depicted in
Figure&#x00A0;<a 
href="#x1-24003r1">10(a)<!--tex4ht:ref: fig:input-1 --></a> (height) and Figure&#x00A0;<a 
href="#x1-24004r2">10(b)<!--tex4ht:ref: fig:input-2 --></a> (velocity). Both the projection onto <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are shown. Figure&#x00A0;<a 
href="#x1-2400611">11<!--tex4ht:ref: fig:input-3 --></a> depicts
the corresponding hybrid arc for the position state.
</p><!--l. 112--><p class="indent" >   These simulations reflect the expected behavior of the bouncing ball model. Note the only difference between this
example and the example of a bouncing ball without a constant input is that, in this example, the ball
bounces on a platform at a height of the chosen input value 0<span 
class="cmmi-10">.</span>2 rather than the ground at a value of
0.
</p><!--l. 115--><p class="indent" >   For MATLAB/Simulink files of this example, see Examples/Example_<a 
href="#x1-240013">1.3<!--tex4ht:ref: ex:bbinput --></a>.
                                                                                         _ 
</p>
   </div>
   <div class="newtheorem">
<!--l. 1--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.4</span> </span>(alternate way to simulate the bouncing ball) <a 
 id="x1-240074"></a>
</p><!--l. 4--><p class="indent" >   Consider the bouncing ball system with a constant input and regular data as given in Example &#x00A0;1.3. This
example shows that a MATLAB function block, such as the jump set <span 
class="cmti-10">D</span>, can be replaced with operational
blocks in Simulink. Figure&#x00A0;<a 
href="#x1-2400812">12<!--tex4ht:ref: fig:bbblocks --></a> shows this implementation. The other functions and solutions are the same as
in Example &#x00A0;1.3.
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2400812"></a>
<div class="center" 
>
<!--l. 7--><p class="noindent" >
</p><!--l. 8--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20318x.png" alt="PIC" class="graphics" width="446.26582pt" height="242.06567pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20318x.png" src="figures/Simulink/HybridSimulatorBBblocks.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;12: </span><span  
class="content">Simulink implementation of bouncing ball example with operator blocks</span></div><!--tex4ht:label?: x1-2400812 -->
</div>
   </div><hr class="endfigure" />
<!--l. 14--><p class="indent" >   For MATLAB/Simulink files corresponding to this alternative implementation, see Examples/Example_<a 
href="#x1-240074">1.4<!--tex4ht:ref: ex:bbblocks --></a>.
                                                                                         _ 
</p>
                                                                                         
                                                                                         
   </div>
   <div class="newtheorem">
<!--l. 1--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.5</span> </span>(vehicle following a track with boundaries) <a 
 id="x1-240095"></a>Consider a vehicle modeled by a Dubins vehicle model
traveling along a given track with state vector <span 
class="cmmi-10">x </span>= [<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup> with dynamics given by <img 
src="HyEQ_Toolbox_v20319x.png" alt=" &#x02D9;
&#x03BE;1"  class="dot"  /> = <span 
class="cmmi-10">u</span>cos<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub>, <img 
src="HyEQ_Toolbox_v20320x.png" alt=" &#x02D9;
&#x03BE;2"  class="dot"  /> = <span 
class="cmmi-10">u</span>sin<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub>,
and <img 
src="HyEQ_Toolbox_v20321x.png" alt=" &#x02D9;
&#x03BE;3"  class="dot"  /> = <span 
class="cmsy-10">-</span><span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub> + <span 
class="cmmi-10">r</span>(<span 
class="cmmi-10">q</span>). The input <span 
class="cmmi-10">u </span>is the tangential velocity of the vehicle, <span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub> describe the vehicle&#8217;s position
on the plane, and <span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub> is the vehicle&#8217;s orientation angle. Also consider a switching controller attempting to keep the
vehicle inside the boundaries of a track given by <span 
class="cmsy-10">{</span>(<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub>) : <span 
class="cmsy-10">-</span>1 <span 
class="cmsy-10">&#x2264; </span><span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmsy-10">&#x2264; </span>1<span 
class="cmsy-10">}</span>. A state <span 
class="cmmi-10">q </span><span 
class="cmsy-10">&#x2208;{</span>1<span 
class="cmmi-10">,</span>2<span 
class="cmsy-10">} </span>is used to define the
modes of operation of the controller. When <span 
class="cmmi-10">q </span>= 1, the vehicle is traveling to the left, and when <span 
class="cmmi-10">q </span>= 2, the vehicle is
traveling to the right. A logic variable <span 
class="cmmi-10">r </span>is defined in order to steer the vehicle back inside the boundary. The state
of the closed-loop system is given by <span 
class="cmmi-10">x </span>:= [<span 
class="cmmi-10">&#x03BE;</span><sup><span 
class="cmsy-7">&#x22A4;</span></sup><span 
class="cmmi-10">&#x00A0;q</span>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup>. A model of such a closed-loop system is given by
</p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20322x.png" alt="           &#x230A;  &#x230A;           &#x230B; &#x230B;
                 ucos(&#x03BE;3)              {
           ||  &#x2308;  usin(&#x03BE;3)  &#x2309; ||            3&#x03C0;4- if q = 1
f(x,u)  :=  &#x2308;    - &#x03BE;3 + r(q) &#x2309;,  r(q) :=    &#x03C0;4  if q = 2                        (6)
                    u
    C   :=  { (&#x03BE;,u) &#x2208; &#x211D;3 &#x00D7; {1,2} &#x00D7; &#x211D; | (&#x03BE; &#x2264; 1,q = 2) or (&#x03BE; &#x2265; - 1,q = 1)},      (7)
           (  [ ]                   1              1
           ||{   &#x03BE;   if  &#x03BE;1 &#x2264; - 1, q = 1
g(&#x03BE;,u)  :=     [2]                    ,                                     (8)
           ||(   &#x03BE;   if  &#x03BE;1 &#x2265; 1, q = 2
           {   1                                               }
   D    :=    (&#x03BE;,u) &#x2208; &#x211D;3 &#x00D7; {1,2} &#x00D7; &#x211D; | (&#x03BE;1 &#x2265; 1,q = 2) or (&#x03BE;1 &#x2264; - 1,q = 1)      (9)
" class="math-display"  /></center>
</div>
<!--l. 33--><p class="indent" >   The MATLAB scripts in each of the function blocks of the implementation above are given as follows. The
tangential velocity of the vehicle is chosen to be <span 
class="cmmi-10">u </span>= 1, the initial position on the plane is chosen to be
(<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub>) = (0<span 
class="cmmi-10">,</span>0), and the initial orientation angle is chosen to be <span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">3</span></sub> = <img 
src="HyEQ_Toolbox_v20323x.png" alt="&#x03C0;
4"  class="frac" align="middle" /> radians.
</p>
                                                                                         
                                                                                         
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2401313"></a> <a 
 id="x1-24011r1"></a> <img 
src="HyEQ_Toolbox_v20324x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20324x.png" src="figures/Examples/DubinsFlowsJumps.eps"  
-->
                                    <span 
class="cmr-8">(a) Trajectory</span>
<a 
 id="x1-24012r2"></a> <img 
src="HyEQ_Toolbox_v20325x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20325x.png" src="figures/Examples/DubinsHybridArc.eps"  
-->
                  <span 
class="cmr-8">(b) Hybrid arc</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;13: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240095">1.5<!--tex4ht:ref: ex:dubinspath --></a></span></div><!--tex4ht:label?: x1-2401313 -->
   </div><hr class="endfigure" />
<!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;z(statevect);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(1);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%x-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(2);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%y-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%orientation</span><span 
class="pcrr7t-">&#x00A0;angle</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(4);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;left</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;right</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;r</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;3&#x22C6;pi/4;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">elseif</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;2</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;r</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;pi/4;</span></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;r</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map:</span><span 
class="pcrr7t-">&#x00A0;xidot=f(xi,u);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u&#x22C6;cos(xi3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%tangential</span><span 
class="pcrr7t-">&#x00A0;velocity</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;x-direction</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u&#x22C6;sin(xi3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%tangential</span><span 
class="pcrr7t-">&#x00A0;velocity</span><span 
class="pcrr7t-">&#x00A0;in</span><span 
class="pcrr7t-">&#x00A0;y-direction</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-xi3</span><span 
class="pcrr7t-">&#x00A0;+</span><span 
class="pcrr7t-">&#x00A0;r;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%angular</span><span 
class="pcrr7t-">&#x00A0;velocity</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">21</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;qdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">22</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xi1dot;xi2dot;xi3dot;qdot];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;z(statevect);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(1);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%x-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(2);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%y-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%orientation</span><span 
class="pcrr7t-">&#x00A0;angle</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(4);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;left</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;right</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;</span><span 
class="pcrr7t-">&#x00A0;1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;2))</span><span 
class="pcrr7t-">&#x00A0;||</span><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;</span><span 
class="pcrr7t-">&#x00A0;-1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1))</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;z(statevect);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(1);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%x-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(2);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%y-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%orientation</span><span 
class="pcrr7t-">&#x00A0;angle</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(4);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;left</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;right</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1plus=xi1;</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2plus=xi2;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3plus=xi3;</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;qplus=q;</span></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;2))</span><span 
class="pcrr7t-">&#x00A0;||</span><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;-1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1))</span></span><br 
class="newline" /><span 
class="cmr-7">16</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;qplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;3-q;</span></span><br 
class="newline" /><span 
class="cmr-7">17</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">18</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;qplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;q;</span></span><br 
class="newline" /><span 
class="cmr-7">19</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">20</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xi1plus;xi2plus;xi3plus;qplus];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;z(statevect);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(1);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%x-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(2);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%y-position</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi3</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(3);</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%orientation</span><span 
class="pcrr7t-">&#x00A0;angle</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi(4);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;left</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;q</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;2</span><span 
class="pcrr7t-">&#x00A0;--&#x003E;</span><span 
class="pcrr7t-">&#x00A0;going</span><span 
class="pcrr7t-">&#x00A0;right</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;2))</span><span 
class="pcrr7t-">&#x00A0;||</span><span 
class="pcrr7t-">&#x00A0;((xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;-1)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(q</span><span 
class="pcrr7t-">&#x00A0;==</span><span 
class="pcrr7t-">&#x00A0;1))</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">15</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 92--><p class="indent" >   A solution to the system of a vehicle following a track in <span 
class="cmsy-10">{</span>(<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub>) : <span 
class="cmsy-10">-</span>1 <span 
class="cmsy-10">&#x2264; </span><span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmsy-10">&#x2264; </span>1<span 
class="cmsy-10">}</span>, and with <span 
class="cmmi-10">T </span>= 15<span 
class="cmmi-10">,J </span>= 10,
<span 
class="cmmi-10">rule </span>= 1, is depicted in Figure&#x00A0;<a 
href="#x1-24011r1">13(a)<!--tex4ht:ref: fig:Dubins-1 --></a> (trajectory). Both the projection onto <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are shown. Figure&#x00A0;<a 
href="#x1-24012r2">13(b)<!--tex4ht:ref: fig:Dubins-2 --></a> depicts
the corresponding hybrid arc.
</p><!--l. 97--><p class="indent" >   For MATLAB/Simulink files of this example, see Examples/Example_<a 
href="#x1-240095">1.5<!--tex4ht:ref: ex:dubinspath --></a>.
                                                                                         _ 
</p>
   </div>
   <div class="newtheorem">
<!--l. 2--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.6</span> </span>(interconnection of hybrid systems <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> (bouncing ball) and <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> (moving platform)) <a 
 id="x1-240146"></a>Consider
a bouncing ball (<span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub>) bouncing on a platform (<span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub>) at some initial height and converging to the ground at
zero height. This is an interconnection problem because the current states of each system affect the behavior
of the other system. In this interconnection, the bouncing ball will contact the platform, bounce back up,
and cause a jump in height of the platform so that it gets closer to the ground. After some time, both the
ball and the platform will converge to the ground. In order to model this system, the output of the bouncing
ball becomes the input of the moving platform, and vice versa. For the simulation of the described system
with regular data where <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> is given by
</p>
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20326x.png" alt="                         [              ]
            f1(&#x03BE;,u1,v1) :=       &#x03BE;2       ,C1 := {(&#x03BE;,u1) | &#x03BE;1 &#x2265; u1,u1 &#x2265; 0}       (10)
            [            ] - &#x03B3; - b&#x03BE;2 + v11
               &#x03BE;1 + &#x03B1;1&#x03BE;22
g1(&#x03BE;,u1,v1) :=  e1|&#x03BE;2|+ v12   ,D1 := {(&#x03BE;,u1) | &#x03BE;1 = u1,u1 &#x2265; 0},y1 = h1(&#x03BE;) := &#x03BE;1    (11)
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">&#x03B3;,b,&#x03B1;</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmmi-10">&#x003E; </span>0<span 
class="cmmi-10">,e</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmsy-10">&#x2208; </span>[0<span 
class="cmmi-10">,</span>1), <span 
class="cmmi-10">&#x03BE; </span>= [<span 
class="cmmi-10">&#x03BE;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03BE;</span><sub><span 
class="cmr-7">2</span></sub>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup> is the state, <span 
class="cmmi-10">y</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D; </span>is the output, <span 
class="cmmi-10">u</span><sub><span 
class="cmr-7">1</span></sub> <span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D; </span>and <span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">1</span></sub> = [<span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">11</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmr-7">12</span></sub>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup><span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmr-7">2</span></sup> are
the inputs, and the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> is given by
   <div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20327x.png" alt="                          [      &#x03B7;        ]
             f2(&#x03B7;,u2,v2) :=  - &#x03B7; - 22&#x03B7; + v   ,C2 := {(&#x03B7;,u2) | &#x03B7;1 &#x2264; u2,&#x03B7;1 &#x2265; 0}      (12)
             [            ]   1    2   12
g2(&#x03B7;,u2,v2) :=  &#x03B7;1 - &#x03B1;2|&#x03B7;2|   ,D2 := {(&#x03B7;,u2) | &#x03B7;1 = u2,&#x03B7;1 &#x2265; 0},y2 = h2(&#x03B7;) := &#x03B7;1   (13)
              - e2|&#x03B7;2|+ v22
" class="math-display"  /></center>
</div>where <span 
class="cmmi-10">&#x03B1;</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmmi-10">&#x003E; </span>0<span 
class="cmmi-10">,e</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmsy-10">&#x2208; </span>[0<span 
class="cmmi-10">,</span>1), <span 
class="cmmi-10">&#x03B7; </span>= [<span 
class="cmmi-10">&#x03B7;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03B7;</span><sub><span 
class="cmr-7">2</span></sub>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup><span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmr-7">2</span></sup> is the state, <span 
class="cmmi-10">y</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D; </span>is the output, and <span 
class="cmmi-10">u</span><sub><span 
class="cmr-7">2</span></sub> <span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D; </span>and <span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">2</span></sub> = [<span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">21</span></sub><span 
class="cmmi-10">,v</span><sub><span 
class="cmr-7">22</span></sub>]<sup><span 
class="cmsy-7">&#x22A4;</span></sup><span 
class="cmsy-10">&#x2208; </span><span 
class="msbm-10">&#x211D;</span><sup><span 
class="cmr-7">2</span></sup>
are the inputs.
<!--l. 44--><p class="indent" >   Therefore, the interconnection may be defined by the input assignment
</p>
   <table 
class="equation"><tr><td><a 
 id="x1-24017r14"></a>
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20328x.png" alt="u1 = y2,   u2 = y1.
" class="math-display"  /></center></td><td class="equation-label">(14)</td></tr></table>
<!--l. 47--><p class="nopar" >
</p><!--l. 49--><p class="indent" >   The signals <span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmmi-10">v</span><sub><span 
class="cmr-7">2</span></sub> are included as external inputs in the model in order to simulate the effects of
environmental perturbations, such as a wind gust, on the system.
</p><!--l. 51--><p class="indent" >   The MATLAB scripts in each of the function blocks of the implementation above are given as follows. The
constants for the interconnected system are <span 
class="cmmi-10">&#x03B3; </span>= 0<span 
class="cmmi-10">.</span>8, <span 
class="cmmi-10">b </span>= 0<span 
class="cmmi-10">.</span>1, and <span 
class="cmmi-10">&#x03B1;</span><sub><span 
class="cmr-7">1</span></sub><span 
class="cmmi-10">,&#x03B1;</span><sub><span 
class="cmr-7">2</span></sub> = 0<span 
class="cmmi-10">.</span>1.
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2401814"></a>
<div class="center" 
>
<!--l. 55--><p class="noindent" >
                                                                                         
                                                                                         
</p><!--l. 56--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20329x.png" alt="PIC" class="graphics" width="281.85587pt" height="311.56517pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20329x.png" src="figures/Simulink/InterconnectionMdl.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;14: </span><span  
class="content">MATLAB/Simulink implementation of interconnected hybrid systems <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub></span></div><!--tex4ht:label?: x1-2401814 -->
</div>
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2401915"></a>
<div class="center" 
>
<!--l. 64--><p class="noindent" >
                                                                                         
                                                                                         
</p><!--l. 69--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20330x.png" alt="PIC" class="graphics" width="375.80544pt" height="282.53006pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20330x.png" src="figures/Examples/InterconnectionH1H2.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;15: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240146">1.6<!--tex4ht:ref: ex:interconnection1 --></a>: height and velocity</span></div><!--tex4ht:label?: x1-2401915 -->
</div>
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2402216"></a> <a 
 id="x1-24020r1"></a> <img 
src="HyEQ_Toolbox_v20331x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20331x.png" src="figures/Examples/InterconnectionH1.eps"  
-->
                                       <span 
class="cmr-8">(a) Height</span>
                                                                                         
                                                                                         
<a 
 id="x1-24021r2"></a> <img 
src="HyEQ_Toolbox_v20332x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20332x.png" src="figures/Examples/InterconnectionH1velocity.eps"  
-->
                   <span 
class="cmr-8">(b) Velocity</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;16: </span><span  
class="content">Solution of Example <a 
href="#x1-240146">1.6<!--tex4ht:ref: ex:interconnection1 --></a> for system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub></span></div><!--tex4ht:label?: x1-2402216 -->
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2402517"></a> <a 
 id="x1-24023r1"></a> <img 
src="HyEQ_Toolbox_v20333x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.54413pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20333x.png" src="figures/Examples/InterconnectionH2.eps"  
-->
                                       <span 
class="cmr-8">(a) Height</span>
<a 
 id="x1-24024r2"></a> <img 
src="HyEQ_Toolbox_v20334x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20334x.png" src="figures/Examples/InterconnectionH2velocity.eps"  
-->
                   <span 
class="cmr-8">(b) Velocity</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;17: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240146">1.6<!--tex4ht:ref: ex:interconnection1 --></a> for system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub></span></div><!--tex4ht:label?: x1-2402517 -->
   </div><hr class="endfigure" />
                                                                                         
                                                                                         
<!--l. 151--><p class="indent" >   For hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub>:
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v11</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v12</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%xdot=f(x,u);</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;xi2;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-0.8-0.1&#x22C6;xi2+v11;</span></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xi1dot;xi2dot];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v11</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v12</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;y2)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v11</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v12</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%jump</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1plus=y2+0.1&#x22C6;xi2^2;</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2plus=0.8&#x22C6;abs(xi2)+v12;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[xi1plus;xi2plus];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xi2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v11</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v12</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(xi1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;y2)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 169--><p class="indent" >   For hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub>:
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v21</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v22</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;eta2;</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2dot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-eta1-2&#x22C6;eta2+v21;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xdot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[eta1dot;eta2dot];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v21</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v22</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(eta1</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;y1)</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v21</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v22</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1plus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;y1-0.1&#x22C6;abs(eta2);</span></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2plus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;-0.8&#x22C6;abs(eta2)+v22;</span></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;xplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;[eta1plus;eta2plus];</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(x,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;state</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(1);</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;eta2</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;x(2);</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%input</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;y1</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(1);</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v21</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(2);</span></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v22</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;u(3);</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">10</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(eta1</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;y1)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">11</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">12</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">13</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">14</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 187--><p class="indent" >   A solution to the interconnection of hybrid systems <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> with <span 
class="cmmi-10">T </span>= 18<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 1, is depicted in
Figure&#x00A0;<a 
href="#x1-2401915">15<!--tex4ht:ref: fig:interconnection-2 --></a>. Both the projection onto <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are shown. A solution to the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> is depicted in
Figure&#x00A0;<a 
href="#x1-24020r1">16(a)<!--tex4ht:ref: fig:interconnection-3 --></a> (height) and Figure&#x00A0;<a 
href="#x1-24021r2">16(b)<!--tex4ht:ref: fig:interconnection-4 --></a> (velocity). A solution to the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> is depicted in Figure&#x00A0;<a 
href="#x1-24023r1">17(a)<!--tex4ht:ref: fig:interconnection-5 --></a>
(height) and Figure&#x00A0;<a 
href="#x1-24024r2">17(b)<!--tex4ht:ref: fig:interconnection-6 --></a> (velocity).
</p><!--l. 194--><p class="indent" >   These simulations reflect the expected behavior of the interconnected hybrid systems.
</p><!--l. 196--><p class="indent" >   For MATLAB/Simulink files of this example, see Examples/Example_<a 
href="#x1-240146">1.6<!--tex4ht:ref: ex:interconnection1 --></a>.
                                                                                         _ 
</p>
   </div>
   <div class="newtheorem">
<!--l. 2--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.7</span> </span>(biological example: synchronization of two fireflies) <a 
 id="x1-240267"></a>Consider a biological example of
the synchronization of two fireflies flashing. The fireflies can be modeled mathematically as periodic
oscillators which tend to synchronize their flashing until they are flashing in phase with each other. A
state value of <span 
class="cmmi-10">&#x03C4;</span><sub><span 
class="cmmi-7">i</span></sub> = 1 corresponds to a flash, and after each flash, the firefly automatically resets its
internal timer (periodic cycle) to <span 
class="cmmi-10">&#x03C4;</span><sub><span 
class="cmmi-7">i</span></sub> = 0. The synchronization of the fireflies can be modeled as an
interconnection of two hybrid systems because every time one firefly flashes, the other firefly notices and
jumps ahead in its internal timer <span 
class="cmmi-10">&#x03C4; </span>by (1 + <span 
class="cmmi-10">&#x03B5;</span>)<span 
class="cmmi-10">&#x03C4;</span>, where <span 
class="cmmi-10">&#x03B5; </span>is a biologically determined coefficient. This
happens until eventually both fireflies synchronize their internal timers and are flashing simultaneously.
</p><hr class="figure" /><div class="figure" 
><a 
 id="x1-2402718"></a>
<div class="center" 
>
<!--l. 5--><p class="noindent" >
</p><!--l. 6--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20335x.png" alt="PIC" class="graphics" width="211.38832pt" height="197.77232pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20335x.png" src="figures/Simulink/fireflies.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;18: </span><span  
class="content">Interconnection Diagram for Example&#x00A0;<a 
href="#x1-240267">1.7<!--tex4ht:ref: ex:fireflies --></a></span></div><!--tex4ht:label?: x1-2402718 -->
</div>
   </div><hr class="endfigure" />
<!--l. 11--><p class="indent" >   Each firefly can be modeled as a hybrid system given by </p><div class="eqnarray">
                                                                                         
                                                                                         
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20336x.png" alt="fi(&#x03C4;i,ui)  :=   1,                                                          (15)
     C   :=   {(&#x03C4; ,u) &#x2208; &#x211D;2 | 0 &#x2264; &#x03C4; &#x2264; 1 }&#x2229; {(&#x03C4;,u ) &#x2208; &#x211D;2 | 0 &#x2264; u &#x2264; 1}       (16)
      i      { i  i           i         i  i            i
gi(&#x03C4;i,ui)  :=     (1+ &#x03B5;)&#x03C4;i  (1+ &#x03B5;)&#x03C4;i &#x003C; 1                                     (17)
             { 0        (1+ &#x03B5;)&#x03C4;i}&#x2265; 1{                  }
    Di   :=    (&#x03C4;i,ui) &#x2208; &#x211D;2 | &#x03C4;i = 1 &#x222A; (&#x03C4;i,ui) &#x2208; &#x211D;2 | ui = 1 .              (18)
" class="math-display"  /></center>
</div>The interconnection diagram for this example is simpler than in the previous example because now no external
inputs are being considered. The only event that affects the flashing of a firefly is the flashing of the other firefly.
The interconnection diagram can be seen in Figure&#x00A0;<a 
href="#x1-2402718">18<!--tex4ht:ref: fig:fireflies --></a>.
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2403119"></a> <a 
 id="x1-24029r1"></a> <img 
src="HyEQ_Toolbox_v20337x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20337x.png" src="figures/Examples/fireflyH1.eps"  
-->
                            <span 
class="cmr-8">(a) Solution for system </span><span 
class="cmsy-8"><img 
src="cmsy8-48.png" alt="H" class="8x-x-48" /></span><sub><span 
class="cmr-6">1</span></sub>
<a 
 id="x1-24030r2"></a> <img 
src="HyEQ_Toolbox_v20338x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.92044pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20338x.png" src="figures/Examples/fireflyH2.eps"  
-->
              <span 
class="cmr-8">(b) Solution for system </span><span 
class="cmsy-8"><img 
src="cmsy8-48.png" alt="H" class="8x-x-48" /></span><sub><span 
class="cmr-6">2</span></sub>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;19: </span><span  
class="content">Solution of Example <a 
href="#x1-240267">1.7<!--tex4ht:ref: ex:fireflies --></a></span></div><!--tex4ht:label?: x1-2403119 -->
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2403220"></a>
                                                                                         
                                                                                         
<div class="center" 
>
<!--l. 52--><p class="noindent" >
</p><!--l. 56--><p class="noindent" ><img 
src="HyEQ_Toolbox_v20339x.png" alt="PIC" class="graphics" width="375.80544pt" height="282.53006pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20339x.png" src="figures/Examples/fireflyH1H2.eps"  
-->
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;20: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240267">1.7<!--tex4ht:ref: ex:fireflies --></a> for interconnection of <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub></span></div><!--tex4ht:label?: x1-2403220 -->
</div>
   </div><hr class="endfigure" />
<!--l. 62--><p class="indent" >   For hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmmi-7">i</span></sub>, <span 
class="cmmi-10">i </span>= 1<span 
class="cmmi-10">,</span>2:
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;taudot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;f(tau,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;taudot</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;C(tau,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;((tau</span><span 
class="pcrr7t-">&#x00A0;&#x003E;</span><span 
class="pcrr7t-">&#x00A0;0)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(tau</span><span 
class="pcrr7t-">&#x00A0;&#x003C;</span><span 
class="pcrr7t-">&#x00A0;1))</span><span 
class="pcrr7t-">&#x00A0;||</span><span 
class="pcrr7t-">&#x00A0;((u</span><span 
class="pcrr7t-">&#x00A0;&#x003E;</span><span 
class="pcrr7t-">&#x00A0;0)</span><span 
class="pcrr7t-">&#x00A0;&amp;&amp;</span><span 
class="pcrr7t-">&#x00A0;(u</span><span 
class="pcrr7t-">&#x00A0;&#x003C;=</span><span 
class="pcrr7t-">&#x00A0;1))</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;flow</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;flow</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;tauplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;g(tau,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;map</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(1+e)&#x22C6;tau</span><span 
class="pcrr7t-">&#x00A0;&#x003C;</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tauplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;(1+e)&#x22C6;tau;</span></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">elseif</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(1+e)&#x22C6;tau</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;1</span></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tauplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">8</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;tauplus</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;tau;</span></span><br 
class="newline" /><span 
class="cmr-7">9</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 25--><p class="noindent" ><span 
class="cmr-7">1</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">function</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;D(tau,</span><span 
class="pcrr7t-">&#x00A0;u)</span></span><br 
class="newline" /><span 
class="cmr-7">2</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;set</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">3</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">if</span></span><span class="verb"><span 
class="pcrr7t-">&#x00A0;(u</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;1)</span><span 
class="pcrr7t-">&#x00A0;||</span><span 
class="pcrr7t-">&#x00A0;(tau</span><span 
class="pcrr7t-">&#x00A0;&#x003E;=</span><span 
class="pcrr7t-">&#x00A0;1)</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;jump</span><span 
class="pcrr7t-">&#x00A0;condition</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">4</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;1;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">5</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">else</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">6</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;v</span><span 
class="pcrr7t-">&#x00A0;=</span><span 
class="pcrr7t-">&#x00A0;0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">%</span><span 
class="pcrr7t-">&#x00A0;do</span><span 
class="pcrr7t-">&#x00A0;not</span><span 
class="pcrr7t-">&#x00A0;report</span><span 
class="pcrr7t-">&#x00A0;jump</span></span><span class="verb"></span><br 
class="newline" /><span 
class="cmr-7">7</span><span class="verb"><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span></span><span class="verb"><span 
class="pcrr7t-">end</span></span><span class="verb"></span><br 
class="newline" />
</p><!--l. 80--><p class="indent" >   A solution to the interconnection of hybrid systems <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> and <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> with <span 
class="cmmi-10">T </span>= 15<span 
class="cmmi-10">,J </span>= 15, <span 
class="cmmi-10">rule </span>= 1, <span 
class="cmmi-10">&#x03B5; </span>= 0<span 
class="cmmi-10">.</span>3 is
depicted in Figure&#x00A0;<a 
href="#x1-2403220">20<!--tex4ht:ref: fig:fireflyH1H2 --></a>. Both the projection onto <span 
class="cmmi-10">t </span>and <span 
class="cmmi-10">j </span>are shown. A solution to the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">1</span></sub> is depicted
in Figure&#x00A0;<a 
href="#x1-24029r1">19(a)<!--tex4ht:ref: fig:fireflyH1 --></a>. A solution to the hybrid system <span 
class="cmsy-10"><img 
src="cmsy10-48.png" alt="H" class="10x-x-48" /></span><sub><span 
class="cmr-7">2</span></sub> is depicted in Figure&#x00A0;<a 
href="#x1-24030r2">19(b)<!--tex4ht:ref: fig:fireflyH2 --></a>.
</p><!--l. 83--><p class="indent" >   These simulations reflect the expected behavior of the interconnected hybrid systems. The fireflies initially flash
out of phase with one another and then synchronize to flash in the same phase.
</p><!--l. 85--><p class="indent" >   For MATLAB/Simulink files of this example, see Examples/Example_<a 
href="#x1-240267">1.7<!--tex4ht:ref: ex:fireflies --></a>.
                                                                                         _ 
</p>
   </div>
   <div class="newtheorem">
<!--l. 2--><p class="noindent" ><span class="head">
<span 
class="cmbx-10">Example</span><span 
class="cmbx-10">&#x00A0;1.8</span> </span>(a simple mathematical example to show different type of simulation results) <a 
 id="x1-240338"></a>Consider the hybrid
system with data </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20340x.png" alt="f(x) := - x, C := [0,1], g(x) := 1+ mod (x,2), D := {1} &#x222A;{2} .
" class="math-display"  /></center>
</div>
<!--l. 12--><p class="indent" >   Note that solutions from <span 
class="cmmi-10">&#x03BE; </span>= 1 and <span 
class="cmmi-10">&#x03BE; </span>= 2 are nonunique. The following simulations show the use of the variable
<span 
class="cmmi-10">rule </span>in the <span 
class="cmti-10">Jump Logic block</span>. <br 
class="newline" />
</p><!--l. 19--><p class="indent" >   <span 
class="cmbx-10">Jumps enforced: </span><br 
class="newline" />
</p><!--l. 22--><p class="indent" >   A solution from <span 
class="cmmi-10">x</span>0 = 1 with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 1 is depicted in Figure&#x00A0;<a 
href="#x1-24035r1">21(a)<!--tex4ht:ref: fig:overlap1-1 --></a>. The solution jumps from 1 to
2, and from 2 to 1 repetitively. <br 
class="newline" />
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2404021"></a>
<a 
 id="x1-24035r1"></a>
                                                                                         
                                                                                         
<!--l. 47--><p class="noindent" > <img 
src="HyEQ_Toolbox_v20341x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20341x.png" src="figures/Examples/Overlap1JumpPriority.eps"  
-->
               <span 
class="cmr-8">(a) Forced jumps logic.</span>
<a 
 id="x1-24036r2"></a>
</p><!--l. 51--><p class="noindent" > <img 
src="HyEQ_Toolbox_v20342x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20342x.png" src="figures/Examples/Overlap1FlowPriority.eps"  
-->
               <span 
class="cmr-8">(b) Forced flows logic.</span>
<a 
 id="x1-24037r3"></a> <img 
src="HyEQ_Toolbox_v20343x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20343x.png" src="figures/Examples/Overlap1RandomPriority.eps"  
-->
         <span 
class="cmr-8">(c) Random logic for flowing/jumping.</span>
<a 
 id="x1-24038r4"></a>
                                                                                         
                                                                                         
</p><!--l. 59--><p class="noindent" > <img 
src="HyEQ_Toolbox_v20344x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20344x.png" src="figures/Examples/Overlap1TRandomPriority.eps"  
-->
         <span 
class="cmr-8">(d) Random logic for flowing/jumping.</span>
<a 
 id="x1-24039r5"></a> <img 
src="HyEQ_Toolbox_v20345x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20345x.png" src="figures/Examples/Overlap1TRandomPriorityZoom.eps"  
-->
   <span 
class="cmr-8">(e) Random logic for flowing/jumping. Zoomed version.</span>
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;21: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240338">1.8<!--tex4ht:ref: ex:overlap1 --></a></span></div><!--tex4ht:label?: x1-2404021 -->
   </div><hr class="endfigure" />
<!--l. 69--><p class="indent" >   <span 
class="cmbx-10">Flows enforced: </span><br 
class="newline" />
</p><!--l. 72--><p class="indent" >   A solution from <span 
class="cmmi-10">x</span>0 = 1 with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 2 is depicted in Figure&#x00A0;<a 
href="#x1-24036r2">21(b)<!--tex4ht:ref: fig:overlap1-2 --></a>. The solution flows for all time
and converges exponentially to zero. <br 
class="newline" />
</p><!--l. 89--><p class="indent" >   <span 
class="cmbx-10">Random rule: </span><br 
class="newline" />
</p><!--l. 92--><p class="indent" >   A solution from <span 
class="cmmi-10">x</span>0 = 1 with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 3 is depicted in Figure&#x00A0;<a 
href="#x1-24037r3">21(c)<!--tex4ht:ref: fig:overlap1-3 --></a>. The solution jumps to 2, then
jumps to 1 and flows for the rest of the time converging to zero exponentially.
</p><!--l. 109--><p class="indent" >   Enlarging <span 
class="cmmi-10">D </span>to </p><div class="eqnarray">
   <center class="math-display" >
<img 
src="HyEQ_Toolbox_v20346x.png" alt="D  := [1&#x2215;50,1]&#x222A; {2}
" class="math-display"  /></center>
</div>causes the overlap between <span 
class="cmmi-10">C </span>and <span 
class="cmmi-10">D </span>to be &#8220;thicker&#8221;. The simulation result is depicted in Figure&#x00A0;<a 
href="#x1-24038r4">21(d)<!--tex4ht:ref: fig:overlap1T-1 --></a> with the
same parameters used in the simulation in Figure&#x00A0;<a 
href="#x1-24037r3">21(c)<!--tex4ht:ref: fig:overlap1-3 --></a>. The plot suggests that the solution jumps several times
until <span 
class="cmmi-10">x &#x003C; </span>1<span 
class="cmmi-10">&#x2215;</span>50 from where it flows to zero. However, Figure&#x00A0;<a 
href="#x1-24039r5">21(e)<!--tex4ht:ref: fig:overlap1T-2 --></a>, a zoomed version of Figure&#x00A0;<a 
href="#x1-24038r4">21(d)<!--tex4ht:ref: fig:overlap1T-1 --></a>, shows that
initially the solution flows and that at (<span 
class="cmmi-10">t,j</span>) = (0<span 
class="cmmi-10">.</span>2<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3<span 
class="cmmi-10">,</span>0) it jumps. After the jump, it continues flowing, then it
jumps a few times, then it flows, etc. The combination of flowing and jumping occurs while the solution is in the
intersection of <span 
class="cmmi-10">C </span>and <span 
class="cmmi-10">D</span>, where the selection of whether flowing or jumping is done randomly due to using
<span 
class="cmmi-10">rule </span>= 3.
<!--l. 129--><p class="indent" >   This simulation also reveals that this implementation does not precisely generate hybrid arcs. The maximum
step size was set to 0<span 
class="cmmi-10">.</span>1<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3. The solution flows during the first two steps of the integration of the
flows with maximum step size. The value at <span 
class="cmmi-10">t </span>= 0<span 
class="cmmi-10">.</span>1<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3 is very close to 1. At <span 
class="cmmi-10">t </span>= 0<span 
class="cmmi-10">.</span>2<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3, instead of
assuming a value given by the flow map, the value of the solution is about 0<span 
class="cmmi-10">.</span>5, which is the result
of the jump occurring at (0<span 
class="cmmi-10">.</span>2<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3<span 
class="cmmi-10">,</span>0). This is the value stored in <span 
class="cmmi-10">x </span>at such time by the integrator.
Note that the value of <span 
class="cmmi-10">x</span><span 
class="cmsy-10">&#x2032; </span>at (0<span 
class="cmmi-10">.</span>2<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3<span 
class="cmmi-10">,</span>0) is the one given by the flow map that triggers the jump,
and if available for recording, it should be stored in (0<span 
class="cmmi-10">.</span>2<span 
class="cmmi-10">e </span><span 
class="cmsy-10">- </span>3<span 
class="cmmi-10">,</span>0). This is a limitation of the current
implementation.
</p><!--l. 167--><p class="indent" >   The following simulations show the <span 
class="cmti-10">Stop Logic block </span>stopping the simulation at different events.
<br 
class="newline" />
</p>
   <hr class="figure" /><div class="figure" 
><a 
 id="x1-2404422"></a> <a 
 id="x1-24042r1"></a> <img 
src="HyEQ_Toolbox_v20347x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20347x.png" src="figures/Examples/Overlap2JumpPriority.eps"  
-->
              <span 
class="cmr-8">(a) Forced jump logic and different </span><span 
class="cmmi-8">D</span><span 
class="cmr-8">.</span>
                                                                                         
                                                                                         
<a 
 id="x1-24043r2"></a> <img 
src="HyEQ_Toolbox_v20348x.png" alt="PIC" class="graphics" width="211.38832pt" height="158.90532pt"  /><!--tex4ht:graphics  
name="HyEQ_Toolbox_v20348x.png" src="figures/Examples/Overlap4FlowPriority.eps"  
-->
                <span 
class="cmr-8">(b) Forced flow logic.</span>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;22: </span><span  
class="content">Solution of Example&#x00A0;<a 
href="#x1-240338">1.8<!--tex4ht:ref: ex:overlap1 --></a> with premature stopping.</span></div><!--tex4ht:label?: x1-2404422 -->
   </div><hr class="endfigure" />
<!--l. 205--><p class="indent" >   <span 
class="cmbx-10">Solution outside </span><span 
class="cmmi-10">C </span><span 
class="cmsy-10">&#x222A; </span><span 
class="cmmi-10">D</span><span 
class="cmbx-10">: </span><br 
class="newline" />
</p><!--l. 208--><p class="indent" >   Taking <span 
class="cmmi-10">D </span>= <span 
class="cmsy-10">{</span>1<span 
class="cmsy-10">}</span>, a simulation starting from <span 
class="cmmi-10">x</span>0 = 1 with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20, <span 
class="cmmi-10">rule </span>= 1 stops since the solution leaves
<span 
class="cmmi-10">C </span><span 
class="cmsy-10">&#x222A; </span><span 
class="cmmi-10">D</span>. Figure&#x00A0;<a 
href="#x1-24042r1">22(a)<!--tex4ht:ref: fig:overlap2-1 --></a> shows this. <br 
class="newline" />
</p><!--l. 212--><p class="indent" >   <span 
class="cmbx-10">Solution reaches the boundary of </span><span 
class="cmmi-10">C </span><span 
class="cmbx-10">from where jumps are not possible: </span><br 
class="newline" />
</p><!--l. 215--><p class="indent" >   Replacing the flow set by [1<span 
class="cmmi-10">&#x2215;</span>2<span 
class="cmmi-10">,</span>1] a solution starting from <span 
class="cmmi-10">x</span>0 = 1 with <span 
class="cmmi-10">T </span>= 10<span 
class="cmmi-10">,J </span>= 20 and <span 
class="cmmi-10">rule </span>= 2
flows for all time until it reaches the boundary of <span 
class="cmmi-10">C </span>where jumps are not possible. Figure&#x00A0;<a 
href="#x1-24043r2">22(b)<!--tex4ht:ref: fig:overlap4-1 --></a> shows
this.
</p><!--l. 222--><p class="indent" >   Note that in this implementation, the Stop Logic is such that when the state of the hybrid system is not in
(<span 
class="cmmi-10">C </span><span 
class="cmsy-10">&#x222A; </span><span 
class="cmmi-10">D</span>), then the simulation is stopped. In particular, if this condition becomes true while flowing, then the last
value of the computed solution will not belong to <span 
class="cmmi-10">C</span>. It could be desired to be able to recompute the solution so that
its last point belongs to the corresponding set. From that point, it should be the case that solutions cannot be
continued.
</p><!--l. 243--><p class="indent" >   For MATLAB/Simulink files of this example, see Examples/Example_<a 
href="#x1-240338">1.8<!--tex4ht:ref: ex:overlap1 --></a>.                                      _ 
</p>
   </div>
<!--l. 757--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-250006"></a>Further Reading</h3>
<!--l. 759--><p class="noindent" >Installation files for the HyEQ Toolbox described in this paper can be found at MATLAB Central and at the
author&#8217;s website </p>
<div class="center" 
>
<!--l. 760--><p class="noindent" >
</p><!--l. 761--><p class="noindent" ><a 
href="https://hybrid.soe.ucsc.edu/software" class="url" ><span 
class="cmtt-10">https://hybrid.soe.ucsc.edu/software</span></a>.</p></div>
<!--l. 763--><p class="noindent" >Also, resources and examples are shared by the HyEQ Toolbox users in the blog </p>
<div class="center" 
>
                                                                                         
                                                                                         
<!--l. 764--><p class="noindent" >
</p><!--l. 765--><p class="noindent" ><a 
href="http://hybridsimulator.wordpress.com" class="url" ><span 
class="cmtt-10">http://hybridsimulator.wordpress.com</span></a>.</p></div>
<!--l. 768--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-260007"></a>Acknowledgments</h3>
<!--l. 771--><p class="noindent" >We would like to thank Giampiero Campa for his thoughtful feedback and advice as well as Torstein Ingebrigtsen Bo
for his comments and initial version of the lite simulator code.
</p><!--l. 773--><p class="indent" >   Also, we would like to include the list of people that help us to test this toolbox:
</p>
     <ul class="itemize1">
     <li class="itemize">Cenk Oguz Saglam - University of California, Santa Barbara
     </li>
     <li class="itemize">Bharani Malladi - The University of Arizona</li></ul>
<!--l. 779--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-270008"></a>References</h3>
<!--l. 784--><p class="noindent" >[1] R. G. Sanfelice, D. A. Copp, and P. Nanez &#8220;A Toolbox for Simulation of Hybrid Systems in Matlab/Simulink:
Hybrid Equations (HyEQ) Toolbox&#8221;, Proceedings of Hybrid Systems: Computation and Control Conference, pp.
101&#8211;106, 2013. <br 
class="newline" />[2] <a 
href="http://control.ee.ethz.ch/~ifaatic/ex/example1.m" class="url" ><span 
class="cmtt-10">http://control.ee.ethz.ch/</span><span 
class="cmtt-10">~</span><span 
class="cmtt-10">ifaatic/ex/example1.m</span></a>. Institut für Automatik - Automatic Control
Laboratory, ETH Zurich, 2011. <br 
class="newline" />[3] R. Goebel, R. G. Sanfelice, and A. R. Teel, Hybrid dynamical systems. IEEE Control Systems Magazine, 28-93,
2009. <br 
class="newline" />[4] R. G. Sanfelice and A. R. Teel, Dynamical Properties of Hybrid Systems Simulators. Automatica, 46, No. 2,
239&#8211;248, 2010. <br 
class="newline" />[5] Sanfelice, R. G., Interconnections of Hybrid Systems: Some Challenges and Recent Results Journal of Nonlinear
Systems and Applications, 111&#8211;121, 2011.
                                                                                         
                                                                                         
                                                                                         
                                                                                         
</p>
    
</body></html> 

                                                                                         


